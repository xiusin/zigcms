<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZigCMS SQL ORM - ç°ä»£åŒ–çš„å¤šæ•°æ®åº“ ORM æ¡†æ¶</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Fluent Design é…è‰² - æŸ”å’Œè‡ªç„¶ */
            --primary: #0078d4;
            --primary-hover: #106ebe;
            --primary-light: #e6f3ff;
            --secondary: #6c757d;
            --success: #107c10;
            --success-light: #dff6dd;
            --warning: #ff8c00;
            --danger: #e81123;
            --bg: #f3f3f3;
            --bg-elevated: #ffffff;
            --text: #323130;
            --text-secondary: #605e5c;
            --border: #e1dfdd;
            --shadow: rgba(0, 0, 0, 0.08);
            --shadow-hover: rgba(0, 0, 0, 0.14);
            --code-bg: #f5f5f5;
            --sidebar-width: 280px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            color: var(--text);
            background: var(--bg);
            line-height: 1.6;
        }

        /* å¯¼èˆªæ  */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: var(--bg-elevated);
            border-bottom: 1px solid var(--border);
            box-shadow: 0 2px 8px var(--shadow);
            z-index: 1000;
            backdrop-filter: blur(20px);
        }

        .navbar-content {
            max-width: 1400px;
            margin: 0 auto;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 20px;
            font-weight: 600;
            color: var(--text);
            text-decoration: none;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary), var(--primary-hover));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .nav-links {
            display: flex;
            gap: 8px;
            list-style: none;
        }

        .nav-links a {
            padding: 8px 16px;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-size: 14px;
        }

        .nav-links a:hover {
            background: var(--primary-light);
            color: var(--primary);
        }

        /* ä¸»å®¹å™¨ */
        .container {
            display: flex;
            margin-top: 60px;
            min-height: calc(100vh - 60px);
        }

        /* ä¾§è¾¹æ  */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--bg-elevated);
            border-right: 1px solid var(--border);
            position: fixed;
            top: 60px;
            bottom: 0;
            overflow-y: auto;
            padding: 24px 0;
        }

        .sidebar::-webkit-scrollbar {
            width: 8px;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        .sidebar-section {
            margin-bottom: 24px;
        }

        .sidebar-title {
            padding: 0 24px 8px;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin: 2px 12px;
        }

        .sidebar-menu a {
            display: block;
            padding: 8px 12px;
            color: var(--text);
            text-decoration: none;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .sidebar-menu a:hover {
            background: var(--primary-light);
            color: var(--primary);
        }

        .sidebar-menu a.active {
            background: var(--primary);
            color: white;
            font-weight: 500;
        }

        /* ä¸»å†…å®¹åŒº */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 40px;
            max-width: 900px;
        }

        /* Hero åŒºåŸŸ */
        .hero {
            padding: 60px 0 40px;
            text-align: center;
        }

        .hero h1 {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 16px;
            background: linear-gradient(135deg, var(--primary), var(--primary-hover));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            font-size: 20px;
            color: var(--text-secondary);
            margin-bottom: 32px;
        }

        .hero-badges {
            display: flex;
            justify-content: center;
            gap: 12px;
            flex-wrap: wrap;
            margin-bottom: 32px;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: 20px;
            font-size: 13px;
            color: var(--text-secondary);
            gap: 6px;
        }

        .badge-icon {
            width: 16px;
            height: 16px;
            border-radius: 50%;
        }

        .badge-success {
            border-color: var(--success);
            color: var(--success);
        }

        /* å¡ç‰‡ */
        .card {
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px var(--shadow);
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: 0 4px 16px var(--shadow-hover);
            transform: translateY(-2px);
        }

        /* æ–‡æ¡£å†…å®¹ */
        .section {
            margin-bottom: 48px;
        }

        .section h2 {
            font-size: 32px;
            font-weight: 600;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--primary);
            color: var(--text);
        }

        .section h3 {
            font-size: 24px;
            font-weight: 600;
            margin: 32px 0 16px;
            color: var(--text);
        }

        .section h4 {
            font-size: 18px;
            font-weight: 600;
            margin: 24px 0 12px;
            color: var(--text);
        }

        .section p {
            margin-bottom: 16px;
            line-height: 1.8;
            color: var(--text);
        }

        /* ä»£ç å— */
        pre {
            background: var(--code-bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
            overflow-x: auto;
            margin: 16px 0;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }

        code {
            background: var(--code-bg);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            color: var(--danger);
        }

        pre code {
            background: none;
            padding: 0;
            color: var(--text);
        }

        /* æ³¨æ„æ¡† */
        .note {
            background: var(--primary-light);
            border-left: 4px solid var(--primary);
            padding: 16px;
            border-radius: 8px;
            margin: 16px 0;
        }

        .note-title {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .warning {
            background: #fff4e6;
            border-left: 4px solid var(--warning);
        }

        .warning .note-title {
            color: var(--warning);
        }

        .success {
            background: var(--success-light);
            border-left: 4px solid var(--success);
        }

        .success .note-title {
            color: var(--success);
        }

        /* æŒ‰é’® */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.2s ease;
        }

        .btn:hover {
            background: var(--primary-hover);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 120, 212, 0.3);
        }

        .btn-secondary {
            background: var(--bg-elevated);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--border);
            box-shadow: 0 2px 8px var(--shadow);
        }

        /* è¡¨æ ¼ */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 24px 0;
            background: var(--bg-elevated);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px var(--shadow);
        }

        th {
            background: var(--primary-light);
            color: var(--primary);
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }

        td {
            padding: 12px;
            border-top: 1px solid var(--border);
            font-size: 14px;
        }

        tr:hover {
            background: var(--bg);
        }

        /* åŠŸèƒ½ç½‘æ ¼ */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 32px 0;
        }

        .feature-card {
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            border-color: var(--primary);
            box-shadow: 0 4px 16px var(--shadow-hover);
            transform: translateY(-4px);
        }

        .feature-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary), var(--primary-hover));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            margin-bottom: 16px;
        }

        .feature-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .feature-desc {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.6;
        }

        /* åº•éƒ¨ */
        .footer {
            background: var(--bg-elevated);
            border-top: 1px solid var(--border);
            padding: 40px 24px;
            text-align: center;
            color: var(--text-secondary);
            font-size: 14px;
            margin-top: 60px;
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .main-content {
                margin-left: 0;
                padding: 20px;
            }

            .hero h1 {
                font-size: 36px;
            }
        }

        /* æ»šåŠ¨è¡Œä¸º */
        html {
            scroll-behavior: smooth;
        }

        /* é€‰æ‹©æ–‡æœ¬æ ·å¼ */
        ::selection {
            background: var(--primary-light);
            color: var(--primary);
        }
    </style>
</head>

<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="navbar-content">
            <a href="#" class="logo">
                <div class="logo-icon">Z</div>
                <span>ZigCMS SQL ORM</span>
            </a>
            <ul class="nav-links">
                <li><a href="#quick-start">å¿«é€Ÿå¼€å§‹</a></li>
                <li><a href="#guide">æŒ‡å—</a></li>
                <li><a href="https://github.com/yourusername/zigcms" target="_blank">GitHub</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <!-- ä¾§è¾¹æ  -->
        <aside class="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">å¼€å§‹ä½¿ç”¨</div>
                <ul class="sidebar-menu">
                    <li><a href="#overview" class="active">æ¦‚è¿°</a></li>
                    <li><a href="#installation">å®‰è£…</a></li>
                    <li><a href="#quick-start">å¿«é€Ÿå¼€å§‹</a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">æ¨¡å‹</div>
                <ul class="sidebar-menu">
                    <li><a href="#declaring-models">å£°æ˜æ¨¡å‹</a></li>
                    <li><a href="#conventions">çº¦å®š</a></li>
                    <li><a href="#fields">å­—æ®µç±»å‹</a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">CRUD</div>
                <ul class="sidebar-menu">
                    <li><a href="#create">åˆ›å»º</a></li>
                    <li><a href="#query">æŸ¥è¯¢</a></li>
                    <li><a href="#update">æ›´æ–°</a></li>
                    <li><a href="#delete">åˆ é™¤</a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">æŸ¥è¯¢</div>
                <ul class="sidebar-menu">
                    <li><a href="#query-builder">æŸ¥è¯¢æ„å»ºå™¨</a></li>
                    <li><a href="#where">æ¡ä»¶æŸ¥è¯¢</a></li>
                    <li><a href="#ordering">æ’åº</a></li>
                    <li><a href="#pagination">åˆ†é¡µ</a></li>
                    <li><a href="#joins">å…³è”æŸ¥è¯¢</a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">é«˜çº§åŠŸèƒ½</div>
                <ul class="sidebar-menu">
                    <li><a href="#migrations">æ•°æ®åº“è¿ç§»</a></li>
                    <li><a href="#cli-tools">å‘½ä»¤è¡Œå·¥å…·</a></li>
                    <li><a href="#aggregates">èšåˆå‡½æ•°</a></li>
                    <li><a href="#subqueries">å­æŸ¥è¯¢</a></li>
                    <li><a href="#relations">å…³è”æŸ¥è¯¢</a></li>
                    <li><a href="#transactions">äº‹åŠ¡</a></li>
                    <li><a href="#raw-sql">åŸå§‹ SQL</a></li>
                    <li><a href="#logging">æ—¥å¿—</a></li>
                    <li><a href="#connection-pool">è¿æ¥æ± </a></li>
                    <li><a href="#thread-safety">çº¿ç¨‹å®‰å…¨</a></li>
                    <li><a href="#performance">æ€§èƒ½ä¼˜åŒ–</a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">æ•°æ®åº“é©±åŠ¨</div>
                <ul class="sidebar-menu">
                    <li><a href="#mysql">MySQL</a></li>
                    <li><a href="#sqlite">SQLite</a></li>
                    <li><a href="#postgresql">PostgreSQL</a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">æµ‹è¯•</div>
                <ul class="sidebar-menu">
                    <li><a href="#testing">æµ‹è¯•è¦†ç›–</a></li>
                </ul>
            </div>
        </aside>

        <!-- ä¸»å†…å®¹ -->
        <main class="main-content">
            <!-- Hero -->
            <div class="hero">
                <h1>ZigCMS SQL ORM</h1>
                <p>ç°ä»£åŒ–çš„ Zig è¯­è¨€å¤šæ•°æ®åº“ ORM æ¡†æ¶</p>
                <div class="hero-badges">
                    <span class="badge badge-success">
                        <span class="badge-icon" style="background: var(--success);">âœ“</span>
                        ç±»å‹å®‰å…¨
                    </span>
                    <span class="badge badge-success">
                        <span class="badge-icon" style="background: var(--success);">âœ“</span>
                        é›¶åå°„
                    </span>
                    <span class="badge badge-success">
                        <span class="badge-icon" style="background: var(--success);">âœ“</span>
                        å¤šæ•°æ®åº“
                    </span>
                    <span class="badge badge-success">
                        <span class="badge-icon" style="background: var(--success);">âœ“</span>
                        çº¿ç¨‹å®‰å…¨
                    </span>
                </div>
                <div>
                    <a href="#quick-start" class="btn">ç«‹å³å¼€å§‹</a>
                    <a href="https://github.com/yourusername/zigcms" class="btn btn-secondary">æŸ¥çœ‹æºç </a>
                </div>
            </div>

            <!-- åŠŸèƒ½ç‰¹æ€§ -->
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">ğŸ¯</div>
                    <div class="feature-title">ç±»å‹å®‰å…¨</div>
                    <div class="feature-desc">ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥ï¼Œæ¶ˆé™¤è¿è¡Œæ—¶é”™è¯¯</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">âš¡</div>
                    <div class="feature-title">é«˜æ€§èƒ½</div>
                    <div class="feature-desc">é›¶å¼€é”€æŠ½è±¡ï¼Œæ¥è¿‘åŸç”Ÿ SQL æ€§èƒ½</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ”’</div>
                    <div class="feature-title">çº¿ç¨‹å®‰å…¨</div>
                    <div class="feature-desc">å†…ç½® Mutex ä¿æŠ¤ï¼Œæ”¯æŒå¹¶å‘è®¿é—®</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ—„ï¸</div>
                    <div class="feature-title">å¤šæ•°æ®åº“</div>
                    <div class="feature-desc">æ”¯æŒ MySQLã€SQLiteã€PostgreSQL</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ¨</div>
                    <div class="feature-title">ä¼˜é›… API</div>
                    <div class="feature-desc">ç±»ä¼¼ Laravel Eloquent çš„é“¾å¼è°ƒç”¨</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ›¡ï¸</div>
                    <div class="feature-title">å†…å­˜å®‰å…¨</div>
                    <div class="feature-desc">æ˜ç¡®çš„å†…å­˜ç®¡ç†ï¼Œæ— æ³„æ¼</div>
                </div>
            </div>

            <!-- æ¦‚è¿° -->
            <section id="overview" class="section">
                <h2>æ¦‚è¿°</h2>
                <p>
                    ZigCMS SQL ORM æ˜¯ä¸€ä¸ªä¸º Zig è¯­è¨€è®¾è®¡çš„ç°ä»£åŒ– ORM æ¡†æ¶ï¼Œçµæ„Ÿæ¥è‡ª Laravel Eloquent å’Œ GORMã€‚
                    å®ƒæä¾›äº†ç±»å‹å®‰å…¨ã€é«˜æ€§èƒ½çš„æ•°æ®åº“æŠ½è±¡å±‚ï¼Œæ”¯æŒå¤šç§æ•°æ®åº“ç³»ç»Ÿã€‚
                </p>

                <div class="note">
                    <div class="note-title">âœ¨ æ ¸å¿ƒç‰¹æ€§</div>
                    <ul>
                        <li><strong>ç±»å‹å®‰å…¨</strong>ï¼šåˆ©ç”¨ Zig çš„ç¼–è¯‘æ—¶ç‰¹æ€§ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µæ•è·é”™è¯¯</li>
                        <li><strong>é›¶åå°„</strong>ï¼šä½¿ç”¨ comptime å…ƒç¼–ç¨‹ï¼Œæ— è¿è¡Œæ—¶åå°„å¼€é”€</li>
                        <li><strong>å¤šæ•°æ®åº“æ”¯æŒ</strong>ï¼šç»Ÿä¸€ APIï¼Œè½»æ¾åˆ‡æ¢ MySQLã€SQLiteã€PostgreSQL</li>
                        <li><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼šå†…ç½® Mutex ä¿æŠ¤ï¼Œæ”¯æŒå¹¶å‘è®¿é—®</li>
                        <li><strong>å†…å­˜å®‰å…¨</strong>ï¼šæ˜ç¡®çš„å†…å­˜ç®¡ç†ç­–ç•¥ï¼Œé¿å…å†…å­˜æ³„æ¼</li>
                    </ul>
                </div>
            </section>

            <!-- å®‰è£… -->
            <section id="installation" class="section">
                <h2>å®‰è£…</h2>

                <h3>å‰ç½®æ¡ä»¶</h3>
                <ul>
                    <li>Zig 0.15.1 æˆ–æ›´é«˜ç‰ˆæœ¬</li>
                    <li>æ•°æ®åº“é©±åŠ¨ï¼ˆæ ¹æ®ä½¿ç”¨çš„æ•°æ®åº“ï¼‰ï¼š
                        <ul>
                            <li>MySQL: libmysqlclient</li>
                            <li>SQLite: libsqlite3</li>
                            <li>PostgreSQL: pg åº“</li>
                        </ul>
                    </li>
                </ul>

                <h3>macOS å®‰è£…ä¾èµ–</h3>
                <pre><code># MySQL
brew install mysql-client

# SQLiteï¼ˆé€šå¸¸å·²é¢„è£…ï¼‰
brew install sqlite3

# PostgreSQL
brew install postgresql</code></pre>

                <h3>åœ¨é¡¹ç›®ä¸­ä½¿ç”¨</h3>
                <p>å°† ORM æ¨¡å—æ·»åŠ åˆ°æ‚¨çš„é¡¹ç›®ä¸­ï¼š</p>
                <pre><code>// åœ¨ build.zig ä¸­
const sql_module = b.addModule("sql", .{
    .root_source_file = .{ .path = "src/services/sql/mod.zig" },
});

exe.root_module.addImport("sql", sql_module);</code></pre>
            </section>

            <!-- å¿«é€Ÿå¼€å§‹ -->
            <section id="quick-start" class="section">
                <h2>å¿«é€Ÿå¼€å§‹</h2>

                <h3>1. å¯¼å…¥æ¨¡å—</h3>
                <pre><code>const std = @import("std");
const sql = @import("sql");

pub fn main() !void {
    var gpa = std.heap.GeneralPurposeAllocator(.{}){};
    defer _ = gpa.deinit();
    const allocator = gpa.allocator();

    // åˆ›å»ºæ•°æ®åº“è¿æ¥
    var db = try sql.Database.sqlite(allocator, ":memory:");
    defer db.deinit();

    std.debug.print("æ•°æ®åº“è¿æ¥æˆåŠŸ!\n", .{});
}</code></pre>

                <h3>2. å®šä¹‰æ¨¡å‹</h3>
                <pre><code>const User = sql.Model(struct {
    pub const table = "users";
    pub const primary_key = "id";
    
    id: u64,
    name: []const u8,
    email: []const u8,
    age: u32,
    active: bool,
});</code></pre>

                <h3>3. åˆ›å»ºè¡¨</h3>
                <pre><code>_ = try db.rawExec(
    \\CREATE TABLE users (
    \\    id INTEGER PRIMARY KEY AUTOINCREMENT,
    \\    name TEXT NOT NULL,
    \\    email TEXT NOT NULL UNIQUE,
    \\    age INTEGER DEFAULT 0,
    \\    active INTEGER DEFAULT 1
    \\)
);</code></pre>

                <h3>4. åŸºæœ¬æ“ä½œ</h3>
                <pre><code>// åˆ›å»ºç”¨æˆ·
const user = try User.create(&db, .{
    .name = "å¼ ä¸‰",
    .email = "zhang@example.com",
    .age = 25,
    .active = true,
});
std.debug.print("åˆ›å»ºç”¨æˆ· ID: {d}\n", .{user.id});

// æŸ¥è¯¢ç”¨æˆ·
if (try User.find(&db, 1)) |found_user| {
    std.debug.print("æ‰¾åˆ°ç”¨æˆ·: {s}\n", .{found_user.name});
}

// æ›´æ–°ç”¨æˆ·
_ = try User.update(&db, 1, .{ .age = 26 });

// åˆ é™¤ç”¨æˆ·
_ = try User.destroy(&db, 1);</code></pre>

                <div class="success">
                    <div class="note-title">âœ“ æ­å–œï¼</div>
                    æ‚¨å·²ç»æŒæ¡äº† ZigCMS SQL ORM çš„åŸºç¡€ç”¨æ³•ã€‚ç»§ç»­é˜…è¯»äº†è§£æ›´å¤šé«˜çº§åŠŸèƒ½ã€‚
                </div>
            </section>

            <!-- å£°æ˜æ¨¡å‹ -->
            <section id="declaring-models" class="section">
                <h2>å£°æ˜æ¨¡å‹</h2>

                <p>æ¨¡å‹æ˜¯æ•°æ®åº“è¡¨çš„ Zig ç»“æ„ä½“è¡¨ç¤ºã€‚ä½¿ç”¨ <code>sql.Model()</code> å‡½æ•°å®šä¹‰æ¨¡å‹ï¼š</p>

                <h3>åŸºç¡€æ¨¡å‹</h3>
                <pre><code>const User = sql.Model(struct {
    pub const table = "users";          // è¡¨å
    pub const primary_key = "id";       // ä¸»é”®å­—æ®µ
    
    id: u64,
    name: []const u8,
    email: []const u8,
    created_at: ?[]const u8,
});</code></pre>

                <h3>æ”¯æŒçš„å­—æ®µç±»å‹</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Zig ç±»å‹</th>
                            <th>SQL ç±»å‹</th>
                            <th>è¯´æ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>u64, u32, i64, i32</code></td>
                            <td>INTEGER, BIGINT</td>
                            <td>æ•´æ•°ç±»å‹</td>
                        </tr>
                        <tr>
                            <td><code>f64, f32</code></td>
                            <td>FLOAT, DOUBLE</td>
                            <td>æµ®ç‚¹æ•°ç±»å‹</td>
                        </tr>
                        <tr>
                            <td><code>bool</code></td>
                            <td>BOOLEAN, TINYINT</td>
                            <td>å¸ƒå°”ç±»å‹</td>
                        </tr>
                        <tr>
                            <td><code>[]const u8</code></td>
                            <td>TEXT, VARCHAR</td>
                            <td>å­—ç¬¦ä¸²ç±»å‹</td>
                        </tr>
                        <tr>
                            <td><code>?T</code></td>
                            <td>å…è®¸ NULL</td>
                            <td>å¯é€‰ç±»å‹</td>
                        </tr>
                    </tbody>
                </table>

                <h3>å¯é€‰å­—æ®µ</h3>
                <pre><code>const Post = sql.Model(struct {
    pub const table = "posts";
    
    id: u64,
    user_id: u64,
    title: []const u8,
    content: ?[]const u8,        // å¯ä»¥ä¸º NULL
    published_at: ?[]const u8,   // å¯ä»¥ä¸º NULL
    views: u32 = 0,              // é»˜è®¤å€¼
});</code></pre>
            </section>

            <!-- CRUD æ“ä½œ -->
            <section id="create" class="section">
                <h2>åˆ›å»ºè®°å½•</h2>

                <h3>åˆ›å»ºå•æ¡è®°å½•</h3>
                <pre><code>// Laravel é£æ ¼: User::create($data)
const user = try User.create(&db, .{
    .name = "æå››",
    .email = "lisi@example.com",
    .age = 30,
    .active = true,
});

std.debug.print("æ–°ç”¨æˆ· ID: {d}\n", .{user.id});</code></pre>

                <h3>æ‰¹é‡åˆ›å»º</h3>
                <pre><code>const users_data = [_]struct {
    name: []const u8,
    email: []const u8,
    age: u32,
    active: bool,
}{
    .{ .name = "ç”¨æˆ·1", .email = "user1@example.com", .age = 20, .active = true },
    .{ .name = "ç”¨æˆ·2", .email = "user2@example.com", .age = 25, .active = true },
    .{ .name = "ç”¨æˆ·3", .email = "user3@example.com", .age = 30, .active = true },
};

const count = try User.insertMany(&db, @TypeOf(users_data[0]), &users_data);
std.debug.print("æ’å…¥äº† {d} æ¡è®°å½•\n", .{count});</code></pre>

                <div class="note">
                    <div class="note-title">ğŸ’¡ æç¤º</div>
                    <code>create()</code> æ–¹æ³•ä¼šè‡ªåŠ¨è¿”å›æ’å…¥åçš„å®Œæ•´è®°å½•ï¼ŒåŒ…æ‹¬æ•°æ®åº“ç”Ÿæˆçš„ ID å’Œå…¶ä»–å­—æ®µã€‚
                </div>
            </section>

            <section id="query" class="section">
                <h2>æŸ¥è¯¢è®°å½•</h2>

                <h3>é€šè¿‡ä¸»é”®æŸ¥æ‰¾</h3>
                <pre><code>// Laravel é£æ ¼: User::find($id)
if (try User.find(&db, 1)) |user| {
    std.debug.print("ç”¨æˆ·å: {s}\n", .{user.name});
} else {
    std.debug.print("ç”¨æˆ·ä¸å­˜åœ¨\n", .{});
}

// æŸ¥æ‰¾æˆ–æŠ¥é”™
const user = try User.findOrFail(&db, 1);  // ä¸å­˜åœ¨ä¼šæŠ›å‡º error.ModelNotFound</code></pre>

                <h3>è·å–æ‰€æœ‰è®°å½•</h3>
                <pre><code>// Laravel é£æ ¼: User::all()
const users = try User.all(&db);
defer User.freeModels(allocator, users);  // é‡Šæ”¾å†…å­˜

for (users) |user| {
    std.debug.print("{s}: {d}å²\n", .{ user.name, user.age });
}</code></pre>

                <h3>ä½¿ç”¨ List åŒ…è£…å™¨ï¼ˆæ¨èï¼Œæ–° APIï¼‰</h3>
                <pre><code>// ä½¿ç”¨ collect() è¿”å› Listï¼Œè‡ªåŠ¨ç®¡ç†å†…å­˜
var list = try User.collect(&db);
defer list.deinit();  // ä¸€è¡Œé‡Šæ”¾æ‰€æœ‰å†…å­˜ï¼

// List æä¾›çš„ä¾¿æ·æ–¹æ³•
std.debug.print("ç”¨æˆ·æ•°: {d}\n", .{list.count()});
std.debug.print("æ˜¯å¦ä¸ºç©º: {}\n", .{list.isEmpty()});

// è·å–ç¬¬ä¸€ä¸ª/æœ€åä¸€ä¸ª
if (list.first()) |user| {
    std.debug.print("ç¬¬ä¸€ä¸ª: {s}\n", .{user.name});
}
if (list.last()) |user| {
    std.debug.print("æœ€åä¸€ä¸ª: {s}\n", .{user.name});
}

// éå†
for (list.items()) |user| {
    std.debug.print("{s}\n", .{user.name});
}</code></pre>

                <h3>æŸ¥è¯¢å¹¶è¿”å› List</h3>
                <pre><code>// é“¾å¼æŸ¥è¯¢ + collect()
var query = User.query(&db);
defer query.deinit();

_ = query.whereEq("active", 1).orderBy("name", .asc);

var list = try query.collect();
defer list.deinit();

for (list.items()) |user| {
    std.debug.print("{s}\n", .{user.name});
}</code></pre>

                <h3>è·å–ç¬¬ä¸€æ¡è®°å½•</h3>
                <pre><code>// Laravel é£æ ¼: User::first()
if (try User.first(&db)) |user| {
    std.debug.print("ç¬¬ä¸€ä¸ªç”¨æˆ·: {s}\n", .{user.name});
}</code></pre>

                <h3>ç»Ÿè®¡è®°å½•æ•°</h3>
                <pre><code>// Laravel é£æ ¼: User::count()
const total = try User.count(&db);
std.debug.print("æ€»ç”¨æˆ·æ•°: {d}\n", .{total});</code></pre>

                <h3>æ£€æŸ¥è®°å½•æ˜¯å¦å­˜åœ¨</h3>
                <pre><code>if (try User.exists(&db, 1)) {
    std.debug.print("ç”¨æˆ·å­˜åœ¨\n", .{});
}</code></pre>
            </section>

            <section id="update" class="section">
                <h2>æ›´æ–°è®°å½•</h2>

                <h3>æ›´æ–°å•æ¡è®°å½•</h3>
                <pre><code>// Laravel é£æ ¼: User::where('id', $id)->update($data)
const affected = try User.update(&db, 1, .{
    .age = 31,
    .active = false,
});

std.debug.print("æ›´æ–°äº† {d} æ¡è®°å½•\n", .{affected});</code></pre>

                <h3>æ›´æ–°æˆ–åˆ›å»º</h3>
                <pre><code>// Laravel é£æ ¼: User::updateOrCreate()
const user = try User.updateOrCreate(&db,
    .{ .email = "test@example.com" },  // æŸ¥æ‰¾æ¡ä»¶
    .{ .name = "æµ‹è¯•ç”¨æˆ·", .age = 25 }   // æ›´æ–°/åˆ›å»ºæ•°æ®
);

std.debug.print("ç”¨æˆ· ID: {d}\n", .{user.id});</code></pre>

                <h3>æŸ¥æ‰¾æˆ–åˆ›å»ºï¼ˆæ–° APIï¼‰</h3>
                <pre><code>// å¦‚æœæ‰¾åˆ°åˆ™è¿”å›ï¼Œå¦åˆ™åˆ›å»º
const user = try User.firstOrCreate(&db,
    .{ .email = "test@example.com" },  // æŸ¥æ‰¾æ¡ä»¶
    .{ .email = "test@example.com", .name = "æ–°ç”¨æˆ·", .age = 20 }  // åˆ›å»ºæ•°æ®
);</code></pre>

                <h3>è‡ªå¢/è‡ªå‡å­—æ®µï¼ˆæ–° APIï¼‰</h3>
                <pre><code>// è‡ªå¢: views += 1
try Article.increment(&db, article_id, "views", 1);

// è‡ªå‡: stock -= 5
try Product.decrement(&db, product_id, "stock", 5);</code></pre>

                <h3>è·å–å•ä¸ªå­—æ®µå€¼ï¼ˆæ–° APIï¼‰</h3>
                <pre><code>// åªè·å–æŸä¸ªå­—æ®µçš„å€¼
if (try User.getValue(&db, 1, "email")) |email| {
    std.debug.print("Email: {s}\n", .{email});
}</code></pre>

                <h3>è·å–æŸåˆ—æ‰€æœ‰å€¼ï¼ˆæ–° APIï¼‰</h3>
                <pre><code>// pluck: è·å–æŸä¸€åˆ—çš„æ‰€æœ‰å€¼
const emails = try User.pluck(&db, "email");
defer User.freePlucked(allocator, emails);

for (emails) |email| {
    std.debug.print("{s}\n", .{email});
}</code></pre>

                <h3>æŒ‰æ¡ä»¶æ›´æ–°/åˆ é™¤ï¼ˆæ–° APIï¼‰</h3>
                <pre><code>// æ›´æ–°æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è®°å½•
try User.updateWhere(&db, 
    .{ .status = "inactive" },  // æ¡ä»¶
    .{ .deleted = 1 }           // æ›´æ–°å€¼
);

// åˆ é™¤æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è®°å½•
try User.deleteWhere(&db, "status", "=", "deleted");</code></pre>

                <div class="warning">
                    <div class="note-title">âš ï¸ æ³¨æ„</div>
                    æ›´æ–°æ“ä½œä¼šè¿”å›å—å½±å“çš„è¡Œæ•°ï¼Œä½†ä¸ä¼šè‡ªåŠ¨é‡æ–°åŠ è½½æ¨¡å‹ã€‚å¦‚éœ€æœ€æ–°æ•°æ®ï¼Œè¯·å†æ¬¡æŸ¥è¯¢ã€‚
                </div>
            </section>

            <section id="delete" class="section">
                <h2>åˆ é™¤è®°å½•</h2>

                <h3>åˆ é™¤å•æ¡è®°å½•</h3>
                <pre><code>// Laravel é£æ ¼: User::destroy($id)
const affected = try User.destroy(&db, 1);
std.debug.print("åˆ é™¤äº† {d} æ¡è®°å½•\n", .{affected});</code></pre>

                <h3>æ‰¹é‡åˆ é™¤</h3>
                <pre><code>// ä½¿ç”¨æŸ¥è¯¢æ„å»ºå™¨åˆ é™¤
var query = User.query(&db);
defer query.deinit();

_ = try db.rawExec("DELETE FROM users WHERE age < 18");</code></pre>
            </section>

            <!-- å…³è”æ¨¡å‹ -->
            <section id="relationships" class="section">
                <h2>å…³è”æ¨¡å‹ï¼ˆæ–° APIï¼‰</h2>

                <p>æ”¯æŒ Laravel Eloquent é£æ ¼çš„å…³è”æŸ¥è¯¢ï¼š</p>

                <h3>ä¸€å¯¹å¤šå…³è” (HasMany)</h3>
                <pre><code>// å®šä¹‰æ¨¡å‹
const User = orm.define(struct {
    pub const table_name = "users";
    id: u64,
    name: []const u8,
});

const Post = orm.define(struct {
    pub const table_name = "posts";
    id: u64,
    user_id: u64,
    title: []const u8,
});

// è®¾ç½®é»˜è®¤è¿æ¥
User.use(&db);
Post.use(&db);

// è·å–ç”¨æˆ·çš„æ‰€æœ‰æ–‡ç«  (HasMany)
if (try User.Find(1)) |*u| {
    var user = u.*;
    defer User.freeModel(allocator, &user);
    
    // ä½¿ç”¨ HasMany è·å–å…³è”
    var rel = User.HasMany(Post.Model, "user_id", user.id);
    const posts = try rel.get();
    defer Post.freeModels(allocator, posts);
    
    std.debug.print("ç”¨æˆ· {s} æœ‰ {d} ç¯‡æ–‡ç« \n", .{user.name, posts.len});
}</code></pre>

                <h3>å±äºå…³è” (BelongsTo)</h3>
                <pre><code>// è·å–æ–‡ç« çš„ä½œè€… (BelongsTo)
if (try Post.Find(1)) |*p| {
    var post = p.*;
    defer Post.freeModel(allocator, &post);
    
    // ä½¿ç”¨ BelongsTo è·å–å…³è”
    var rel = Post.BelongsTo(User.Model, post.user_id);
    if (try rel.first()) |*u| {
        var author = u.*;
        defer User.freeModel(allocator, &author);
        std.debug.print("æ–‡ç« ä½œè€…: {s}\n", .{author.name});
    }
}</code></pre>

                <h3>å…³è”æŸ¥è¯¢æ–¹æ³•</h3>
                <pre><code>// å¸¦æ¡ä»¶çš„å…³è”æŸ¥è¯¢
var rel = User.HasMany(Post.Model, "user_id", user_id);
_ = rel.where("status", "=", "published")
       .orderBy("created_at", .desc)
       .limit(10);
const posts = try rel.get();

// è·å–å…³è”æ•°é‡
var rel2 = User.HasMany(Post.Model, "user_id", user_id);
const count = try rel2.count();
rel2.deinit();

// æ£€æŸ¥æ˜¯å¦å­˜åœ¨å…³è”
var rel3 = User.HasMany(Post.Model, "user_id", user_id);
const has_posts = try rel3.exists();  // è‡ªåŠ¨ deinit

// è·å–å…³è”å¹¶è¿”å› List
var rel4 = User.HasMany(Post.Model, "user_id", user_id);
var list = try rel4.collect();
defer list.deinit();</code></pre>

                <div class="note">
                    <div class="note-title">ğŸ’¡ æç¤º</div>
                    ä½¿ç”¨ <code>Model.Model</code> è·å–åŸå§‹ç»“æ„ä½“ç±»å‹ç”¨äºå…³è”æŸ¥è¯¢ã€‚
                </div>
            </section>

            <!-- æŸ¥è¯¢æ„å»ºå™¨ -->
            <section id="query-builder" class="section">
                <h2>æŸ¥è¯¢æ„å»ºå™¨</h2>

                <p>æŸ¥è¯¢æ„å»ºå™¨æä¾›äº†æµç•…çš„é“¾å¼ API æ¥æ„å»ºå¤æ‚æŸ¥è¯¢ï¼š</p>

                <h3>å®Œç¾ Laravel é£æ ¼ï¼ˆæ—  db å‚æ•°ï¼Œæ¨èï¼‰</h3>
                <pre><code>// åˆå§‹åŒ–æ—¶è®¾ç½®é»˜è®¤æ•°æ®åº“è¿æ¥ï¼ˆåªéœ€ä¸€æ¬¡ï¼‰
User.use(&db);
Product.use(&db);

// ç°åœ¨å¯ä»¥åƒ Laravel ä¸€æ ·è°ƒç”¨ï¼å®Œå…¨ä¸éœ€è¦ db å‚æ•°ï¼
var q = User.Where("age", ">", 18);
defer q.deinit();

const users = try q.orderBy("name", .asc).limit(10).get();
defer User.freeModels(allocator, users);

// å®Œç¾çš„ Laravel é£æ ¼æ–¹æ³•
var q1 = User.WhereEq("status", "active");     // WHERE status = 'active'
var q2 = User.WhereLike("name", "%å¼ %");       // WHERE name LIKE '%å¼ %'
var q3 = User.WhereIn("id", &.{1, 2, 3});      // WHERE id IN (1, 2, 3)
var q4 = User.WhereNull("deleted_at");         // WHERE deleted_at IS NULL
var q5 = User.WhereNotNull("email");           // WHERE email IS NOT NULL
var q6 = User.Latest();                        // ORDER BY created_at DESC
var q7 = User.Oldest();                        // ORDER BY created_at ASC
var q8 = User.Take(10);                        // LIMIT 10
var q9 = User.Paginate(1, 20);                 // ç¬¬1é¡µï¼Œæ¯é¡µ20æ¡
var qa = User.OrderBy("name", .asc);           // ORDER BY name ASC

// CRUD æ“ä½œä¹Ÿæ— éœ€ db å‚æ•°
const user = try User.Find(1);                 // æŸ¥æ‰¾
const total = try User.Count();                // ç»Ÿè®¡
var list = try User.Collect();                 // è·å–å…¨éƒ¨
const first = try User.First();                // ç¬¬ä¸€æ¡
const created = try User.Create(.{...});       // åˆ›å»º
try User.Update(1, .{...});                    // æ›´æ–°
try User.Destroy(1);                           // åˆ é™¤

// ä½¿ç”¨ withDB æŒ‡å®šè¿æ¥ï¼ˆç”¨äºäº‹åŠ¡ç­‰åœºæ™¯ï¼‰
_ = try User.withDB(&tx).Create(.{...});       // äº‹åŠ¡ä¸­åˆ›å»º
_ = try User.withDB(&tx).Update(1, .{...});    // äº‹åŠ¡ä¸­æ›´æ–°
_ = try User.withDB(&tx).Destroy(1);           // äº‹åŠ¡ä¸­åˆ é™¤

// é“¾å¼è°ƒç”¨
var results = try User.Where("active", "=", 1)
    .whereGte("age", 18)
    .orderBy("created_at", .desc)
    .take(10)
    .collect();
defer results.deinit();</code></pre>

                <h3>ä¼ ç»Ÿæ–¹å¼ï¼ˆæ˜¾å¼ä¼ é€’ dbï¼‰</h3>
                <pre><code>// å¦‚æœä¸æƒ³è®¾ç½®é»˜è®¤è¿æ¥ï¼Œä»å¯æ˜¾å¼ä¼ é€’ dbï¼ˆå°å†™æ–¹æ³•åï¼‰
var q = User.where(&db, "age", ">", 18);
defer q.deinit();</code></pre>

                <h3>åŸºç¡€æŸ¥è¯¢</h3>
                <pre><code>var query = User.query(&db);
defer query.deinit();

const users = try query
    .where("age", ">", 18)
    .where("active", "=", true)
    .orderBy("name", .asc)
    .limit(10)
    .get();
defer User.freeModels(allocator, users);</code></pre>

                <h3>æŒ‡å®šå­—æ®µæŸ¥è¯¢</h3>
                <pre><code>// Laravel é£æ ¼: User::select(['id', 'name', 'email'])->get()
var query = User.query(&db);
defer query.deinit();

const users = try query
    .select(&.{ "id", "name", "email" })
    .where("age", ">=", 18)
    .get();
defer allocator.free(users);</code></pre>

                <h3>ç”Ÿæˆ SQLï¼ˆä¸æ‰§è¡Œï¼‰</h3>
                <pre><code>var query = User.query(&db);
defer query.deinit();

_ = query
    .where("age", ">", 18)
    .orderBy("created_at", .desc)
    .limit(20);

const sql = try query.toSql();
defer allocator.free(sql);

std.debug.print("ç”Ÿæˆçš„ SQL: {s}\n", .{sql});</code></pre>
            </section>

            <section id="where" class="section">
                <h2>WHERE æ¡ä»¶</h2>

                <h3>åŸºæœ¬ WHERE å­å¥</h3>
                <pre><code>var query = User.query(&db);
defer query.deinit();

// å¤šä¸ª AND æ¡ä»¶
_ = query
    .where("age", ">=", 18)
    .where("age", "<=", 65)
    .where("active", "=", true);</code></pre>

                <h3>WHERE IN</h3>
                <pre><code>// Laravel é£æ ¼: whereIn('id', [1, 2, 3])
_ = query.whereIn("id", &.{ 1, 2, 3, 4, 5 });</code></pre>

                <h3>å­æŸ¥è¯¢ï¼ˆæ–° APIï¼‰</h3>
                <pre><code>// æ–¹å¼1: ä½¿ç”¨ SQL å­—ç¬¦ä¸²ä½œä¸ºå­æŸ¥è¯¢
_ = query.whereInSub("user_id", "SELECT id FROM admins WHERE active = 1");

// æ–¹å¼2: ä½¿ç”¨ QueryBuilder ä½œä¸ºå­æŸ¥è¯¢
var subquery = Admin.query(&db);
defer subquery.deinit();
_ = subquery.select(&.{"id"}).whereEq("active", 1);

var main_query = Order.query(&db);
defer main_query.deinit();
_ = main_query.whereInQuery("user_id", &subquery);

// NOT IN å­æŸ¥è¯¢
_ = query.whereNotInSub("id", "SELECT banned_id FROM blacklist");
_ = query.whereNotInQuery("id", &blacklist_query);

// EXISTS å­æŸ¥è¯¢
_ = query.whereExists("SELECT 1 FROM orders WHERE orders.user_id = users.id");
_ = query.whereExistsQuery(&order_query);

// NOT EXISTS å­æŸ¥è¯¢  
_ = query.whereNotExists("SELECT 1 FROM bans WHERE bans.user_id = users.id");

// å­—æ®µæ¯”è¾ƒ
_ = query.whereColumn("created_at", ">", "updated_at");</code></pre>

                <h3>WHERE NULL</h3>
                <pre><code>// Laravel é£æ ¼: whereNull('deleted_at')
_ = query.whereNull("deleted_at");

// WHERE NOT NULL
_ = query.whereNotNull("email");</code></pre>

                <h3>ç®€åŒ–çš„ WHERE æ–¹æ³•ï¼ˆæ–° APIï¼‰</h3>
                <pre><code>var query = User.query(&db);
defer query.deinit();

// æ–°çš„ç®€åŒ–æ–¹æ³•ï¼ˆä¸éœ€è¦å†™æ“ä½œç¬¦ï¼‰
_ = query
    .whereEq("name", "å¼ ä¸‰")      // WHERE name = 'å¼ ä¸‰'
    .whereNe("status", "deleted") // WHERE status != 'deleted'
    .whereGt("age", 18)           // WHERE age > 18
    .whereGte("age", 18)          // WHERE age >= 18
    .whereLt("price", 100)        // WHERE price < 100
    .whereLte("price", 100)       // WHERE price <= 100
    .whereLike("name", "%å¼ %")    // WHERE name LIKE '%å¼ %'
    .whereNotLike("name", "%test%")
    .whereBetween("age", 18, 65)  // WHERE age BETWEEN 18 AND 65
    .whereNotBetween("price", 0, 10)
    .whereNotIn("id", &.{1, 2})   // WHERE id NOT IN (1, 2)
    .whereRaw("created_at > NOW() - INTERVAL 7 DAY");</code></pre>

                <h3>å¿«æ·æ–¹æ³•</h3>
                <pre><code>var query = User.query(&db);
defer query.deinit();

// æŒ‰æ—¶é—´æ’åº
_ = query.latest();  // ORDER BY created_at DESC
_ = query.oldest();  // ORDER BY created_at ASC

// limit/offset åˆ«å
_ = query.take(10);  // LIMIT 10
_ = query.skip(5);   // OFFSET 5</code></pre>

                <h3>ç»„åˆæ¡ä»¶ç¤ºä¾‹</h3>
                <pre><code>var query = User.query(&db);
defer query.deinit();

const adults = try query
    .select(&.{ "id", "name", "age" })
    .where("age", ">=", 18)
    .where("age", "<=", 65)
    .whereNotNull("email")
    .where("active", "=", true)
    .orderBy("age", .desc)
    .limit(50)
    .get();
defer allocator.free(adults);</code></pre>
            </section>

            <section id="ordering" class="section">
                <h2>æ’åº</h2>

                <h3>å•å­—æ®µæ’åº</h3>
                <pre><code>// å‡åº
_ = query.orderBy("name", .asc);

// é™åº
_ = query.orderBy("created_at", .desc);</code></pre>

                <h3>å¤šå­—æ®µæ’åº</h3>
                <pre><code>var query = User.query(&db);
defer query.deinit();

const users = try query
    .orderBy("age", .desc)
    .orderBy("name", .asc)
    .get();
defer allocator.free(users);</code></pre>
            </section>

            <section id="pagination" class="section">
                <h2>åˆ†é¡µ</h2>

                <h3>ä½¿ç”¨ LIMIT å’Œ OFFSET</h3>
                <pre><code>var query = User.query(&db);
defer query.deinit();

const users = try query
    .limit(20)
    .offset(40)
    .get();
defer allocator.free(users);</code></pre>

                <h3>ä½¿ç”¨ page() æ–¹æ³•</h3>
                <pre><code>// Laravel é£æ ¼åˆ†é¡µ
var query = User.query(&db);
defer query.deinit();

// ç¬¬2é¡µï¼Œæ¯é¡µ20æ¡
const users = try query
    .page(2, 20)
    .get();
defer allocator.free(users);</code></pre>
            </section>

            <section id="joins" class="section">
                <h2>JOIN æŸ¥è¯¢</h2>

                <h3>INNER JOIN</h3>
                <pre><code>var query = User.query(&db);
defer query.deinit();

const users = try query
    .innerJoin("posts", "users.id = posts.user_id")
    .select(&.{ "users.id", "users.name", "posts.title" })
    .get();
defer allocator.free(users);</code></pre>

                <h3>LEFT JOIN</h3>
                <pre><code>var query = User.query(&db);
defer query.deinit();

const users = try query
    .leftJoin("posts", "users.id = posts.user_id")
    .select(&.{ "users.*", "COUNT(posts.id) as post_count" })
    .groupBy(&.{"users.id"})
    .get();
defer allocator.free(users);</code></pre>

                <h3>GROUP BY å’Œ HAVING</h3>
                <pre><code>var query = User.query(&db);
defer query.deinit();

const users = try query
    .select(&.{ "city", "COUNT(*) as count" })
    .groupBy(&.{"city"})
    .having("COUNT(*) > 10")
    .get();
defer allocator.free(users);</code></pre>
            </section>

            <!-- å­æŸ¥è¯¢ -->
            <section id="subqueries" class="section">
                <h2>å­æŸ¥è¯¢</h2>

                <p>å­æŸ¥è¯¢æ˜¯åµŒå¥—åœ¨å…¶ä»–æŸ¥è¯¢ä¸­çš„ SQL æŸ¥è¯¢ï¼Œç”¨äºæ„å»ºå¤æ‚çš„æŸ¥è¯¢é€»è¾‘ã€‚</p>

                <h3>WHERE IN å­æŸ¥è¯¢</h3>
                <pre><code>// æŸ¥æ‰¾æœ‰å·²å‘å¸ƒæ–‡ç« çš„ç”¨æˆ·
var query = User.query(&db);
defer query.deinit();

_ = query.whereInSub(
    "id",
    "SELECT user_id FROM posts WHERE published = 1"
);

const users = try query.get();
defer allocator.free(users);</code></pre>

                <h3>WHERE EXISTS å­æŸ¥è¯¢</h3>
                <pre><code>// æŸ¥æ‰¾æœ‰è¯„è®ºçš„æ–‡ç« 
var query = Post.query(&db);
defer query.deinit();

_ = query.whereExists(
    "SELECT 1 FROM comments WHERE comments.post_id = posts.id"
);

const posts = try query.get();
defer allocator.free(posts);</code></pre>

                <h3>WHERE NOT EXISTS å­æŸ¥è¯¢</h3>
                <pre><code>// æŸ¥æ‰¾æ²¡æœ‰æ–‡ç« çš„ç”¨æˆ·
var query = User.query(&db);
defer query.deinit();

_ = query.whereNotExists(
    "SELECT 1 FROM posts WHERE posts.user_id = users.id"
);

const users = try query.get();
defer allocator.free(users);</code></pre>

                <h3>åµŒå¥—å­æŸ¥è¯¢</h3>
                <pre><code>// æŸ¥æ‰¾æœ‰çƒ­é—¨æ–‡ç« ï¼ˆæµè§ˆ>50ï¼‰çš„æ´»è·ƒç”¨æˆ·
const sql = 
    \\SELECT * FROM users 
    \\WHERE active = 1 
    \\AND id IN (
    \\    SELECT user_id FROM posts 
    \\    WHERE views > 50 AND published = 1
    \\)
;

var result = try db.rawQuery(sql);
defer result.deinit();</code></pre>

                <div class="note">
                    <div class="note-title">ğŸ’¡ æ€§èƒ½æç¤º</div>
                    å­æŸ¥è¯¢åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½å½±å“æ€§èƒ½ã€‚å¯¹äºç®€å•çš„å…³è”æŸ¥è¯¢ï¼Œè€ƒè™‘ä½¿ç”¨ JOIN ä»£æ›¿ã€‚
                </div>
            </section>

            <!-- å…³è”æŸ¥è¯¢ -->
            <section id="relations" class="section">
                <h2>å…³è”æŸ¥è¯¢</h2>

                <p>å…³è”æŸ¥è¯¢ç”¨äºå¤„ç†è¡¨ä¹‹é—´çš„å…³ç³»ï¼Œå¦‚ä¸€å¯¹å¤šã€å¤šå¯¹å¤šç­‰ã€‚</p>

                <h3>ä¸€å¯¹å¤šå…³ç³» (User hasMany Posts)</h3>
                <pre><code>// æŸ¥è¯¢ç”¨æˆ·åŠå…¶æ–‡ç« ç»Ÿè®¡
const sql = 
    \\SELECT 
    \\    u.id as user_id,
    \\    u.name as user_name,
    \\    COUNT(p.id) as post_count,
    \\    SUM(p.views) as total_views
    \\FROM users u
    \\LEFT JOIN posts p ON u.id = p.user_id
    \\GROUP BY u.id, u.name
    \\ORDER BY post_count DESC
;

var result = try db.rawQuery(sql);
defer result.deinit();

while (result.next()) |row| {
    std.debug.print("{s}: {s} ç¯‡æ–‡ç« , {s} æ¬¡æµè§ˆ\\n", .{
        row.getString("user_name") orelse "",
        row.getString("post_count") orelse "0",
        row.getString("total_views") orelse "0",
    });
}</code></pre>

                <h3>å¤šå¯¹ä¸€å…³ç³» (Post belongsTo User)</h3>
                <pre><code>// æŸ¥è¯¢æ–‡ç« åŠä½œè€…ä¿¡æ¯
const sql =
    \\SELECT 
    \\    p.id, p.title, p.views,
    \\    u.id as author_id, u.name as author_name
    \\FROM posts p
    \\INNER JOIN users u ON p.user_id = u.id
    \\WHERE p.published = 1
    \\ORDER BY p.views DESC
;

var result = try db.rawQuery(sql);
defer result.deinit();</code></pre>

                <h3>å¤šå¯¹å¤šå…³ç³» (Posts <-> Tags)</h3>
                <pre><code>// æŸ¥è¯¢æ–‡ç« åŠå…¶æ ‡ç­¾
const sql =
    \\SELECT 
    \\    p.title,
    \\    GROUP_CONCAT(t.name, ', ') as tags
    \\FROM posts p
    \\LEFT JOIN post_tags pt ON p.id = pt.post_id
    \\LEFT JOIN tags t ON pt.tag_id = t.id
    \\WHERE p.published = 1
    \\GROUP BY p.id, p.title
;

var result = try db.rawQuery(sql);
defer result.deinit();</code></pre>

                <h3>é¢„åŠ è½½ï¼ˆé¿å… N+1 é—®é¢˜ï¼‰</h3>
                <div class="warning">
                    <div class="note-title">âš ï¸ N+1 æŸ¥è¯¢é—®é¢˜</div>
                    é¿å…åœ¨å¾ªç¯ä¸­æ‰§è¡ŒæŸ¥è¯¢ã€‚ä½¿ç”¨ JOIN ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰å…³è”æ•°æ®ã€‚
                </div>

                <pre><code>// âŒ é”™è¯¯æ–¹å¼ï¼šN+1 æŸ¥è¯¢
var posts = try Post.all(&db);
defer allocator.free(posts);

for (posts) |post| {
    // æ¯æ¬¡å¾ªç¯æ‰§è¡Œä¸€æ¬¡æŸ¥è¯¢ï¼
    const author = try User.find(&db, post.user_id);
}

// âœ… æ­£ç¡®æ–¹å¼ï¼šä½¿ç”¨ JOIN
const sql =
    \\SELECT 
    \\    p.*, u.id as author_id, u.name as author_name
    \\FROM posts p
    \\INNER JOIN users u ON p.user_id = u.id
;

var result = try db.rawQuery(sql);
defer result.deinit();
// ä¸€æ¬¡æŸ¥è¯¢è·å–æ‰€æœ‰æ•°æ®ï¼</code></pre>

                <h3>ä¸‰è¡¨å…³è”</h3>
                <pre><code>// æŸ¥è¯¢ç”¨æˆ·ã€æ–‡ç« å’Œè¯„è®ºç»Ÿè®¡
const sql =
    \\SELECT 
    \\    u.name as author,
    \\    p.title,
    \\    p.views,
    \\    COUNT(c.id) as comment_count
    \\FROM users u
    \\INNER JOIN posts p ON u.id = p.user_id
    \\LEFT JOIN comments c ON p.id = c.post_id
    \\WHERE p.published = 1
    \\GROUP BY u.name, p.title, p.views
    \\HAVING comment_count > 0
    \\ORDER BY comment_count DESC
;

var result = try db.rawQuery(sql);
defer result.deinit();</code></pre>
            </section>

            <!-- äº‹åŠ¡ -->
            <section id="transactions" class="section">
                <h2>äº‹åŠ¡</h2>

                <h3>æ‰‹åŠ¨äº‹åŠ¡ï¼ˆä¼ ç»Ÿæ–¹å¼ï¼‰</h3>
                <pre><code>// å¼€å§‹äº‹åŠ¡
try db.beginTransaction();
errdefer db.rollback() catch {};

// æ‰§è¡Œæ“ä½œï¼ˆä¼ ç»Ÿæ–¹å¼ï¼Œéœ€ä¼  dbï¼‰
_ = try User.create(&db, user_data);
_ = try Post.create(&db, post_data);

// æäº¤äº‹åŠ¡
try db.commit();</code></pre>

                <h3>Laravel é£æ ¼äº‹åŠ¡ï¼ˆæ¨èï¼‰</h3>
                <pre><code>// å…ˆè®¾ç½®é»˜è®¤è¿æ¥
User.use(&db);
Post.use(&db);

// å¼€å§‹äº‹åŠ¡
try db.beginTransaction();
errdefer db.rollback() catch {};

// ä½¿ç”¨ withDB é“¾å¼è°ƒç”¨æŒ‡å®šäº‹åŠ¡è¿æ¥
_ = try User.withDB(&db).Create(user_data);
_ = try Post.withDB(&db).Create(post_data);

// æäº¤äº‹åŠ¡
try db.commit();</code></pre>

                <h3>è‡ªåŠ¨äº‹åŠ¡ï¼ˆæ›´ç®€æ´ï¼‰</h3>
                <pre><code>// Laravel é£æ ¼: DB::transaction()
try db.transaction(struct {
    fn execute(db_ptr: *sql.Database) !void {
        // ä½¿ç”¨ withDB ç¡®ä¿ä½¿ç”¨åŒä¸€è¿æ¥
        _ = try User.withDB(db_ptr).Create(user_data);
        _ = try Post.withDB(db_ptr).Create(post_data);
        // å¦‚æœå‡ºé”™ä¼šè‡ªåŠ¨å›æ»š
    }
}.execute);</code></pre>

                <div class="note">
                    <div class="note-title">ğŸ’¡ withDB ç”¨æ³•</div>
                    <pre><code>// æ™®é€šæ“ä½œï¼ˆä½¿ç”¨é»˜è®¤è¿æ¥ï¼‰
_ = try User.Create(data);

// äº‹åŠ¡æ“ä½œï¼ˆä½¿ç”¨ withDB æŒ‡å®šè¿æ¥ï¼‰
_ = try User.withDB(&tx).Create(data);
_ = try User.withDB(&tx).Update(1, data);
_ = try User.withDB(&tx).Destroy(1);</code></pre>
                </div>
            </section>

            <!-- åŸå§‹ SQL -->
            <section id="raw-sql" class="section">
                <h2>åŸå§‹ SQL</h2>

                <h3>æ‰§è¡ŒæŸ¥è¯¢</h3>
                <pre><code>var result = try db.rawQuery("SELECT * FROM users WHERE age > 18");
defer result.deinit();

while (result.next()) |row| {
    const name = row.getString("name");
    std.debug.print("ç”¨æˆ·: {s}\n", .{name orelse ""});
}</code></pre>

                <h3>æ‰§è¡Œå‘½ä»¤</h3>
                <pre><code>const affected = try db.rawExec("UPDATE users SET active = 1 WHERE age >= 18");
std.debug.print("æ›´æ–°äº† {d} æ¡è®°å½•\n", .{affected});</code></pre>

                <h3>åˆ›å»ºè¡¨</h3>
                <pre><code>_ = try db.rawExec(
    \\CREATE TABLE users (
    \\    id INTEGER PRIMARY KEY AUTOINCREMENT,
    \\    name TEXT NOT NULL,
    \\    email TEXT NOT NULL UNIQUE,
    \\    age INTEGER DEFAULT 0,
    \\    active INTEGER DEFAULT 1,
    \\    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    \\)
);</code></pre>
            </section>

            <!-- æ—¥å¿— -->
            <section id="logging" class="section">
                <h2>æ—¥å¿—è®°å½•</h2>

                <h3>å¯ç”¨æ—¥å¿—</h3>
                <pre><code>var db = try sql.Database.sqlite(allocator, ":memory:");
defer db.deinit();

// å¯ç”¨ SQL æ—¥å¿—
db.enable_logging = true;
db.debug = true;

// æ‰§è¡ŒæŸ¥è¯¢ - ä¼šè‡ªåŠ¨æ‰“å°æ—¥å¿—
var result = try db.rawQuery("SELECT * FROM users");
defer result.deinit();</code></pre>

                <h3>æ—¥å¿—è¾“å‡ºç¤ºä¾‹</h3>
                <pre><code>[INFO] Query executed: 5 rows, 0.85ms
[SQL] SELECT * FROM users WHERE age > 18

[INFO] Exec executed: 1 rows affected, 0.12ms
[SQL] INSERT INTO users (name, email, age) VALUES ('å¼ ä¸‰', 'zhang@example.com', 25)

[ERROR] Query failed: DatabaseError
[ERROR] SQL: SELECT * FROM non_existent_table
[ERROR] Duration: 0.03ms</code></pre>

                <h3>QueryBuilder è°ƒè¯•æ–¹æ³• â­æ–°å¢</h3>
                <p>åœ¨æŸ¥è¯¢é“¾ä¸­éšæ—¶è°ƒè¯• SQLï¼š</p>

                <pre><code>// ä½¿ç”¨ debug() æŸ¥çœ‹æ¯ä¸€æ­¥çš„ SQL
var builder = User.query(&db);
defer builder.deinit();

_ = builder
    .where("age", ">", 18)
    .debug()  // æ‰“å°å½“å‰ SQL
    .orderBy("name", .asc)
    .debug()  // å†æ¬¡æ‰“å°
    .limit(10);

// è¾“å‡ºï¼š
// [QueryBuilder Debug] SQL: SELECT * FROM users WHERE age > 18
// [QueryBuilder Debug] SQL: SELECT * FROM users WHERE age > 18 ORDER BY name ASC LIMIT 10</code></pre>

                <h3>å¸¦è‡ªå®šä¹‰æ¶ˆæ¯çš„è°ƒè¯•</h3>
                <pre><code>// ä½¿ç”¨ debugWith() æ·»åŠ è¯´æ˜
var builder = User.query(&db);
defer builder.deinit();

_ = builder
    .where("active", "=", true)
    .debugWith("âœ“ æ­¥éª¤1: è¿‡æ»¤æ´»è·ƒç”¨æˆ·")
    .where("age", ">", 18)
    .debugWith("âœ“ æ­¥éª¤2: è¿‡æ»¤æˆå¹´ç”¨æˆ·")
    .limit(10)
    .debugWith("âœ“ æœ€ç»ˆæŸ¥è¯¢");

// è¾“å‡ºï¼š
// [QueryBuilder Debug] âœ“ æ­¥éª¤1: è¿‡æ»¤æ´»è·ƒç”¨æˆ·
// [QueryBuilder Debug] SQL: SELECT * FROM users WHERE active = true
// [QueryBuilder Debug] âœ“ æ­¥éª¤2: è¿‡æ»¤æˆå¹´ç”¨æˆ·
// [QueryBuilder Debug] SQL: SELECT * FROM users WHERE active = true AND age > 18
// ...</code></pre>

                <h3>å¤æ‚æŸ¥è¯¢è°ƒè¯•</h3>
                <pre><code>var builder = User.query(&db);
defer builder.deinit();

_ = builder
    .selectFields(&.{ "id", "name", "email" })
    .whereInSub("id", "SELECT user_id FROM posts WHERE published = 1")
    .debugWith("å­æŸ¥è¯¢æ·»åŠ å")
    .leftJoin("profiles", "users.id = profiles.user_id")
    .debugWith("JOIN æ·»åŠ å")
    .groupBy(&.{"users.id"})
    .debugWith("åˆ†ç»„æ·»åŠ å");

// å¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°æ¯ä¸€æ­¥ SQL çš„å˜åŒ–</code></pre>

                <div class="success">
                    <div class="note-title">âœ“ debug() æ–¹æ³•ç‰¹ç‚¹</div>
                    <ul>
                        <li>æ”¯æŒé“¾å¼è°ƒç”¨ - ä¸ä¸­æ–­æŸ¥è¯¢é“¾</li>
                        <li>å®æ—¶æ‰“å° - éšæ—¶æŸ¥çœ‹ SQL</li>
                        <li>é›¶æ€§èƒ½å½±å“ï¼ˆç”Ÿäº§ç¯å¢ƒä¸ä½¿ç”¨ï¼‰</li>
                        <li>è‡ªå®šä¹‰æ¶ˆæ¯ - ä½¿ç”¨ debugWith()</li>
                    </ul>
                </div>

                <div class="note">
                    <div class="note-title">ğŸ’¡ æ€§èƒ½æç¤º</div>
                    åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®å…³é—­è¯¦ç»†æ—¥å¿—ä»¥æé«˜æ€§èƒ½ã€‚åªåœ¨è°ƒè¯•æ—¶å¯ç”¨ã€‚debug() æ–¹æ³•ä»…ç”¨äºå¼€å‘è°ƒè¯•ï¼Œç”Ÿäº§ä»£ç ä¸­åº”åˆ é™¤ã€‚
                </div>
            </section>

            <!-- çº¿ç¨‹å®‰å…¨ -->
            <section id="thread-safety" class="section">
                <h2>çº¿ç¨‹å®‰å…¨ä¸å¹¶å‘</h2>

                <p>ZigCMS SQL ORM å†…éƒ¨è‡ªåŠ¨ç®¡ç†å¹¶å‘å®‰å…¨ï¼Œç”¨æˆ·æ— éœ€å…³å¿ƒè¿æ¥æ± ç­‰åº•å±‚ç»†èŠ‚ã€‚</p>

                <h3>è®¾è®¡åŸåˆ™</h3>

                <div class="success">
                    <div class="note-title">âœ“ æ ¸å¿ƒç†å¿µ</div>
                    <ul>
                        <li><strong>å†…éƒ¨è‡ªåŠ¨ç®¡ç†</strong> - è¿æ¥æ± ã€é”ã€äº‹åŠ¡ç­‰ç”±æ¡†æ¶å†…éƒ¨å¤„ç†</li>
                        <li><strong>ç”¨æˆ·æ— æ„ŸçŸ¥</strong> - åªéœ€åˆ›å»º Database å¹¶ä½¿ç”¨ï¼Œæ— éœ€å…³å¿ƒç»†èŠ‚</li>
                        <li><strong>å¤šçº¿ç¨‹å®‰å…¨</strong> - è‡ªåŠ¨ä¿è¯çº¿ç¨‹å®‰å…¨</li>
                    </ul>
                </div>

                <h3>PostgreSQLï¼ˆæ¨èï¼‰</h3>
                <pre><code>// âœ… åˆ›å»ºæ•°æ®åº“è¿æ¥
var db = try sql.Database.postgres(allocator, .{
    .host = "localhost",
    .port = 5432,
    .database = "myapp",
});
defer db.deinit();

// âœ… å¤šçº¿ç¨‹ç›´æ¥ä½¿ç”¨ï¼ˆpg.Pool å†…éƒ¨çº¿ç¨‹å®‰å…¨ï¼‰
for (threads) |*thread| {
    thread.* = try std.Thread.spawn(.{}, worker, .{&db});
}

fn worker(db: *sql.Database) void {
    // ç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€å…³å¿ƒè¿æ¥æ± 
    const result = db.rawQuery("SELECT * FROM users") catch return;
    defer result.deinit();
    // å†…éƒ¨è‡ªåŠ¨ç®¡ç†å¹¶å‘
}

// æ€§èƒ½ï¼š10 ä¸ªå¹¶å‘è¿æ¥ï¼Œååé‡ 1000 QPS</code></pre>

                <h3>MySQLï¼ˆå†…éƒ¨è‡ªåŠ¨ä½¿ç”¨è¿æ¥æ± ï¼‰</h3>
                <pre><code>// âœ… åˆ›å»ºæ•°æ®åº“è¿æ¥ï¼ˆå†…éƒ¨è‡ªåŠ¨åˆ›å»ºè¿æ¥æ± ï¼‰
var db = try sql.Database.mysql(allocator, .{
    .host = "localhost",
    .database = "myapp",
    
    // å¯é€‰ï¼šè¿æ¥æ± é…ç½®
    .min_connections = 2,          // æœ€å°è¿æ¥æ•°
    .max_connections = 20,         // æœ€å¤§è¿æ¥æ•°
    .max_idle_time_ms = 300_000,   // ç©ºé—²è¶…æ—¶ 5 åˆ†é’Ÿ
    .max_lifetime_ms = 1_800_000,  // è¿æ¥æœ€å¤§ç”Ÿå‘½å‘¨æœŸ 30 åˆ†é’Ÿ
    .keepalive_interval_ms = 60_000, // ä¿æ´»é—´éš” 60 ç§’ï¼ˆè‡ªåŠ¨ pingï¼‰
});
defer db.deinit();

// âœ… å¤šçº¿ç¨‹ç›´æ¥ä½¿ç”¨ï¼ˆè¿æ¥æ± è‡ªåŠ¨ä¿æ´»ï¼‰
for (threads) |*thread| {
    thread.* = try std.Thread.spawn(.{}, worker, .{&db});
}

fn worker(db: *sql.Database) void {
    // å†…éƒ¨è‡ªåŠ¨ï¼šè·å–è¿æ¥ â†’ æ‰§è¡ŒæŸ¥è¯¢ â†’ å½’è¿˜è¿æ¥
    const result = db.rawQuery("SELECT * FROM users") catch return;
    defer result.deinit();
}

// æ€§èƒ½ï¼š20 ä¸ªå¹¶å‘è¿æ¥ï¼Œååé‡ 1000 QPS</code></pre>

                <h3>SQLiteï¼ˆè‡ªåŠ¨ WAL æ¨¡å¼ï¼‰</h3>
                <pre><code>// âœ… åˆ›å»ºæ•°æ®åº“è¿æ¥ï¼ˆè‡ªåŠ¨å¯ç”¨ WAL æ¨¡å¼ï¼‰
var db = try sql.Database.sqlite(allocator, "app.db");
defer db.deinit();

// æ”¯æŒå¤šä¸ªçº¿ç¨‹å¹¶å‘è¯»ï¼Œå•ä¸ªçº¿ç¨‹å†™
for (threads) |*thread| {
    thread.* = try std.Thread.spawn(.{}, reader, .{&db});
}

fn reader(db: *sql.Database) void {
    const result = db.rawQuery("SELECT * FROM users") catch return;
    defer result.deinit();
}</code></pre>

                <h3>äº‹åŠ¡ï¼ˆè‡ªåŠ¨ç®¡ç†ï¼‰</h3>
                <pre><code>// âœ… ä½¿ç”¨äº‹åŠ¡ï¼ˆå†…éƒ¨è‡ªåŠ¨ç®¡ç†è¿æ¥ï¼‰
try db.transaction(struct {
    fn run(db_ref: *sql.Database) !void {
        try db_ref.rawExec("INSERT INTO users ...");
        try db_ref.rawExec("INSERT INTO logs ...");
        // è‡ªåŠ¨æäº¤ï¼Œå‡ºé”™è‡ªåŠ¨å›æ»š
    }
}.run, .{});

// å†…éƒ¨è‡ªåŠ¨ï¼š
// - MySQLï¼šä»è¿æ¥æ± è·å–ç‹¬å è¿æ¥
// - PostgreSQLï¼šä½¿ç”¨è¿æ¥å†…äº‹åŠ¡
// - SQLiteï¼šä½¿ç”¨è¿æ¥å†…äº‹åŠ¡
// - è¶…æ—¶æ£€æµ‹ï¼ˆ30ç§’ï¼‰
// - è‡ªåŠ¨å›æ»šæœªæäº¤çš„äº‹åŠ¡</code></pre>

                <h3>MySQL é…ç½®é€‰é¡¹</h3>
                <pre><code>var db = try sql.Database.mysql(allocator, .{
    // åŸºç¡€é…ç½®
    .host = "localhost",
    .port = 3306,
    .database = "myapp",
    .user = "root",
    .password = "password",
    
    // è¿æ¥æ± é…ç½®ï¼ˆå¯é€‰ï¼Œå†…éƒ¨ä½¿ç”¨ï¼‰
    .min_connections = 2,              // æœ€å°è¿æ¥æ•°
    .max_connections = 10,             // æœ€å¤§è¿æ¥æ•°
    .acquire_timeout_ms = 5000,        // è·å–è¿æ¥è¶…æ—¶
    .max_idle_time_ms = 300_000,       // è¿æ¥ç©ºé—²è¶…æ—¶ï¼ˆ5åˆ†é’Ÿï¼‰
    .max_lifetime_ms = 1_800_000,      // è¿æ¥ç”Ÿå‘½å‘¨æœŸï¼ˆ30åˆ†é’Ÿï¼‰
    .transaction_timeout_ms = 30_000,  // äº‹åŠ¡è¶…æ—¶ï¼ˆ30ç§’ï¼‰
});

// æ‰€æœ‰è¿™äº›é…ç½®éƒ½æ˜¯å†…éƒ¨ä½¿ç”¨ï¼Œç”¨æˆ·åªéœ€è¦é…ç½®ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†</code></pre>

                <h3>æ€§èƒ½å¯¹æ¯”</h3>
                <pre><code>åœºæ™¯: 100 ä¸ªå¹¶å‘è¯·æ±‚ï¼Œæ¯ä¸ªæŸ¥è¯¢ 10ms

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ æ•°æ®åº“         â”‚ å¹¶å‘åº¦   â”‚ æ€»è€—æ—¶  â”‚ QPS â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ PostgreSQL     â”‚ 10       â”‚ 100ms   â”‚ 1K  â”‚
â”‚ MySQLï¼ˆè¿æ¥æ± ï¼‰â”‚ 20       â”‚ 100ms   â”‚ 1K  â”‚
â”‚ SQLiteï¼ˆWALï¼‰  â”‚ å¤šè¯»1å†™  â”‚ 200ms   â”‚ 500 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜

æ‰€æœ‰æ€§èƒ½ä¼˜åŒ–éƒ½æ˜¯å†…éƒ¨è‡ªåŠ¨å®Œæˆ</code></pre>

                <div class="warning">
                    <div class="note-title">âš ï¸ é‡è¦</div>
                    <ul>
                        <li><strong>ç”¨æˆ·ä¸éœ€è¦æ„ŸçŸ¥è¿æ¥æ± </strong> - å†…éƒ¨è‡ªåŠ¨ç®¡ç†</li>
                        <li><strong>ä¸éœ€è¦æ‰‹åŠ¨è·å–/å½’è¿˜è¿æ¥</strong> - è‡ªåŠ¨å¤„ç†</li>
                        <li><strong>åªéœ€åˆ›å»º Database å¹¶ä½¿ç”¨</strong> - å°±è¿™ä¹ˆç®€å•</li>
                        <li><strong>å¤šçº¿ç¨‹å®‰å…¨</strong> - è‡ªåŠ¨ä¿è¯</li>
                    </ul>
                </div>

                <div class="success">
                    <div class="note-title">âœ“ ç®€å•æ˜“ç”¨</div>
                    <p>å†…éƒ¨è‡ªåŠ¨ç®¡ç†è¿æ¥æ± ã€é”ã€äº‹åŠ¡ï¼Œç”¨æˆ·åªéœ€ä¸“æ³¨ä¸šåŠ¡é€»è¾‘ï¼</p>
                </div>
            </section>

            <!-- æ•°æ®åº“é©±åŠ¨ -->
            <section id="mysql" class="section">
                <h2>MySQL</h2>

                <h3>è¿æ¥ MySQL</h3>
                <pre><code>var db = try sql.Database.mysql(allocator, .{
    .host = "localhost",
    .port = 3306,
    .user = "root",
    .password = "password",
    .database = "myapp",
});
defer db.deinit();</code></pre>

                <h3>MySQL ç‰¹æ€§</h3>
                <ul>
                    <li>æ”¯æŒå®Œæ•´çš„ MySQL è¯­æ³•</li>
                    <li>è‡ªåŠ¨å¢é•¿ä¸»é”®ï¼ˆAUTO_INCREMENTï¼‰</li>
                    <li>äº‹åŠ¡æ”¯æŒï¼ˆInnoDBï¼‰</li>
                    <li>é¢„å¤„ç†è¯­å¥</li>
                </ul>
            </section>

            <section id="sqlite" class="section">
                <h2>SQLite</h2>

                <h3>è¿æ¥ SQLite</h3>
                <pre><code>// å†…å­˜æ•°æ®åº“ï¼ˆæµ‹è¯•ç”¨ï¼‰
var db = try sql.Database.sqlite(allocator, ":memory:");

// æ–‡ä»¶æ•°æ®åº“
var db = try sql.Database.sqlite(allocator, "app.db");

defer db.deinit();</code></pre>

                <h3>SQLite ç‰¹æ€§</h3>
                <ul>
                    <li>é›¶é…ç½®ï¼Œæ— éœ€æœåŠ¡å™¨</li>
                    <li>è½»é‡çº§ï¼Œé€‚åˆå¼€å‘å’Œæµ‹è¯•</li>
                    <li>è‡ªåŠ¨å¢é•¿ä¸»é”®ï¼ˆAUTOINCREMENTï¼‰</li>
                    <li>å®Œæ•´çš„äº‹åŠ¡æ”¯æŒ</li>
                </ul>

                <div class="note">
                    <div class="note-title">ğŸ’¡ æ¨èç”¨é€”</div>
                    SQLite éå¸¸é€‚åˆå¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒå’Œè½»é‡çº§åº”ç”¨ã€‚ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ MySQL æˆ– PostgreSQLã€‚
                </div>
            </section>

            <section id="postgresql" class="section">
                <h2>PostgreSQL</h2>

                <h3>è¿æ¥ PostgreSQL</h3>
                <pre><code>var db = try sql.Database.postgres(allocator, .{
    .host = "localhost",
    .port = 5432,
    .user = "postgres",
    .password = "password",
    .database = "myapp",
});
defer db.deinit();</code></pre>

                <h3>PostgreSQL ç‰¹æ€§</h3>
                <ul>
                    <li>æ”¯æŒå®Œæ•´çš„ PostgreSQL è¯­æ³•</li>
                    <li>SERIAL è‡ªåŠ¨å¢é•¿ä¸»é”®</li>
                    <li>å¼ºå¤§çš„ JSON æ”¯æŒ</li>
                    <li>æ•°ç»„ç±»å‹æ”¯æŒ</li>
                    <li>å…¨æ–‡æœç´¢</li>
                </ul>

                <h3>PostgreSQL ç‰¹æœ‰è¯­æ³•</h3>
                <pre><code>// RETURNING å­å¥è·å–æ’å…¥çš„ ID
_ = try db.rawExec(
    "INSERT INTO users (name, email) VALUES ('å¼ ä¸‰', 'zhang@example.com') RETURNING id"
);

// JSON æŸ¥è¯¢
_ = try db.rawQuery("SELECT data->>'name' as name FROM documents");</code></pre>
            </section>

            <!-- è¿æ¥æ±  -->
            <section id="connection-pool" class="section">
                <h2>è¿æ¥æ± </h2>

                <p>è¿æ¥æ± ç”¨äºç®¡ç†å’Œå¤ç”¨æ•°æ®åº“è¿æ¥ï¼Œæé«˜åº”ç”¨æ€§èƒ½ã€‚</p>

                <h3>PostgreSQL è¿æ¥æ± </h3>
                <p>PostgreSQL é©±åŠ¨å†…ç½®è¿æ¥æ± æ”¯æŒï¼ˆä½¿ç”¨ pg åº“ï¼‰ï¼š</p>

                <pre><code>var db = try sql.Database.postgres(allocator, .{
    .host = "localhost",
    .port = 5432,
    .user = "postgres",
    .password = "password",
    .database = "myapp",
    .connect_timeout = 10,
});
defer db.deinit();

// è¿æ¥æ± è‡ªåŠ¨ç®¡ç†ï¼ˆé»˜è®¤ 5 ä¸ªè¿æ¥ï¼‰
// å¤šä¸ªå¹¶å‘æŸ¥è¯¢ä¼šè‡ªåŠ¨å¤ç”¨è¿æ¥</code></pre>

                <h3>MySQL è¿æ¥ç®¡ç†</h3>
                <pre><code>// MySQL è¿æ¥é…ç½®
var db = try sql.Database.mysql(allocator, .{
    .host = "localhost",
    .port = 3306,
    .user = "root",
    .password = "password",
    .database = "myapp",
});
defer db.deinit();</code></pre>

                <h3>SQLite è¿æ¥</h3>
                <pre><code>// SQLite ä½¿ç”¨æ–‡ä»¶é”æœºåˆ¶
var db = try sql.Database.sqlite(allocator, "app.db");
defer db.deinit();

// æ”¯æŒå¹¶å‘è¯»å–ï¼Œå†™å…¥è‡ªåŠ¨ä¸²è¡ŒåŒ–</code></pre>

                <div class="note">
                    <div class="note-title">ğŸ’¡ æœ€ä½³å®è·µ</div>
                    <ul>
                        <li>ä¸ºåº”ç”¨åˆ›å»ºå•ä¸ªæ•°æ®åº“å®ä¾‹</li>
                        <li>åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å…±äº«æ•°æ®åº“å®ä¾‹ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</li>
                        <li>ä½¿ç”¨ defer ç¡®ä¿è¿æ¥æ­£ç¡®å…³é—­</li>
                        <li>PostgreSQL: è¿æ¥æ± è‡ªåŠ¨ç®¡ç†ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®</li>
                    </ul>
                </div>

                <h3>è¿æ¥ä¿æ´»</h3>
                <pre><code>// é•¿æ—¶é—´è¿è¡Œçš„åº”ç”¨å¯èƒ½éœ€è¦å®šæœŸæ£€æŸ¥è¿æ¥
const std = @import("std");

// ä¿æ´»æ£€æŸ¥å‡½æ•°
fn keepAlive(db: *sql.Database) !void {
    while (true) {
        std.time.sleep(60 * std.time.ns_per_s); // æ¯60ç§’
        
        // æ‰§è¡Œç®€å•æŸ¥è¯¢ä¿æŒè¿æ¥æ´»è·ƒ
        var result = db.rawQuery("SELECT 1") catch |err| {
            std.debug.print("è¿æ¥æ£€æŸ¥å¤±è´¥: {any}\\n", .{err});
            continue;
        };
        result.deinit();
    }
}

// åœ¨åå°çº¿ç¨‹è¿è¡Œ
const thread = try std.Thread.spawn(.{}, keepAlive, .{&db});</code></pre>

                <h3>å¹¶å‘è¿æ¥ç¤ºä¾‹</h3>
                <pre><code>// å¤šçº¿ç¨‹å…±äº«æ•°æ®åº“è¿æ¥
var db = try sql.Database.sqlite(allocator, "shared.db");
defer db.deinit();

var threads: [5]std.Thread = undefined;
for (&threads, 0..) |*thread, i| {
    thread.* = try std.Thread.spawn(.{}, workerFunction, .{ &db, i });
}

// ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
for (&threads) |*thread| {
    thread.join();
}

fn workerFunction(db_ptr: *sql.Database, thread_id: usize) void {
    // æ¯ä¸ªçº¿ç¨‹å®‰å…¨åœ°æ‰§è¡ŒæŸ¥è¯¢
    var result = db_ptr.rawQuery("SELECT * FROM users LIMIT 10") catch return;
    defer result.deinit();
    
    std.debug.print("Thread {d} å®ŒæˆæŸ¥è¯¢\\n", .{thread_id});
}</code></pre>
            </section>

            <!-- æ€§èƒ½ä¼˜åŒ– -->
            <section id="performance" class="section">
                <h2>æ€§èƒ½ä¼˜åŒ–</h2>

                <h3>æ‰¹é‡æ“ä½œ</h3>
                <div class="success">
                    <div class="note-title">âœ“ ä½¿ç”¨äº‹åŠ¡æ‰¹é‡æ’å…¥</div>
                    æ‰¹é‡æ“ä½œæ—¶å§‹ç»ˆä½¿ç”¨äº‹åŠ¡ï¼Œå¯æå‡ 10-100 å€æ€§èƒ½ã€‚
                </div>

                <pre><code>// âœ… æ­£ç¡®æ–¹å¼ï¼šä½¿ç”¨äº‹åŠ¡
try db.beginTransaction();
errdefer db.rollback() catch {};

var i: u32 = 0;
while (i < 1000) : (i += 1) {
    _ = try User.create(&db, user_data);
}

try db.commit();

// âŒ é”™è¯¯æ–¹å¼ï¼šé€æ¡æäº¤
// æ¯æ¬¡æ’å…¥éƒ½ä¼šç­‰å¾…ç£ç›˜å†™å…¥ï¼Œéå¸¸æ…¢ï¼
var i: u32 = 0;
while (i < 1000) : (i += 1) {
    _ = try User.create(&db, user_data); // æ¯æ¬¡è‡ªåŠ¨æäº¤
}</code></pre>

                <h3>ç´¢å¼•ä¼˜åŒ–</h3>
                <pre><code>// ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µåˆ›å»ºç´¢å¼•
_ = try db.rawExec("CREATE INDEX idx_users_email ON users(email)");
_ = try db.rawExec("CREATE INDEX idx_users_age ON users(age)");
_ = try db.rawExec("CREATE INDEX idx_posts_user_id ON posts(user_id)");
_ = try db.rawExec("CREATE INDEX idx_posts_published ON posts(published)");

// å¤åˆç´¢å¼•
_ = try db.rawExec("CREATE INDEX idx_posts_user_published ON posts(user_id, published)");</code></pre>

                <h3>æŸ¥è¯¢ä¼˜åŒ–</h3>
                <pre><code>// âœ… åªæŸ¥è¯¢éœ€è¦çš„å­—æ®µ
var query = User.query(&db);
defer query.deinit();

const users = try query
    .select(&.{ "id", "name", "email" })  // åªé€‰æ‹©éœ€è¦çš„åˆ—
    .where("active", "=", true)
    .limit(100)
    .get();
defer allocator.free(users);

// âŒ é¿å… SELECT *
// ä¼šæµªè´¹å†…å­˜å’Œç½‘ç»œå¸¦å®½</code></pre>

                <h3>é¿å… N+1 æŸ¥è¯¢</h3>
                <table>
                    <thead>
                        <tr>
                            <th>é—®é¢˜</th>
                            <th>æŸ¥è¯¢æ¬¡æ•°</th>
                            <th>æ€§èƒ½</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>N+1 æŸ¥è¯¢</td>
                            <td>1 + N</td>
                            <td>âŒ å¾ˆæ…¢</td>
                        </tr>
                        <tr>
                            <td>JOIN æŸ¥è¯¢</td>
                            <td>1</td>
                            <td>âœ… å¿«é€Ÿ</td>
                        </tr>
                    </tbody>
                </table>

                <h3>è¿æ¥å¤ç”¨</h3>
                <pre><code>// âœ… å¤ç”¨æ•°æ®åº“è¿æ¥
var db = try sql.Database.sqlite(allocator, "app.db");
defer db.deinit();

// åœ¨æ•´ä¸ªåº”ç”¨ç”Ÿå‘½å‘¨æœŸå†…å¤ç”¨è¿™ä¸ªè¿æ¥
for (0..1000) |_| {
    _ = try db.rawQuery("SELECT * FROM users LIMIT 1");
}

// âŒ é¿å…é¢‘ç¹åˆ›å»ºè¿æ¥
// æ¯æ¬¡éƒ½åˆ›å»ºæ–°è¿æ¥éå¸¸æ…¢ï¼
for (0..1000) |_| {
    var db_temp = try sql.Database.sqlite(allocator, "app.db");
    defer db_temp.deinit();
    _ = try db_temp.rawQuery("SELECT * FROM users LIMIT 1");
}</code></pre>

                <h3>EXPLAIN åˆ†ææŸ¥è¯¢</h3>
                <pre><code>// ä½¿ç”¨ EXPLAIN åˆ†ææŸ¥è¯¢æ€§èƒ½
const sql_query = "SELECT * FROM users WHERE age > 18 AND active = 1";

const explain_sql = try std.fmt.allocPrint(allocator, "EXPLAIN QUERY PLAN {s}", .{sql_query});
defer allocator.free(explain_sql);

var result = try db.rawQuery(explain_sql);
defer result.deinit();

std.debug.print("æŸ¥è¯¢è®¡åˆ’:\\n", .{});
while (result.next()) |row| {
    std.debug.print("{s}\\n", .{row.getString("detail") orelse ""});
}</code></pre>

                <h3>æ€§èƒ½ç›‘æ§</h3>
                <pre><code>// è®°å½•æ…¢æŸ¥è¯¢
const start = std.time.nanoTimestamp();

var result = try db.rawQuery(sql);
defer result.deinit();

const end = std.time.nanoTimestamp();
const elapsed_ms = @as(f64, @floatFromInt(end - start)) / 1_000_000.0;

if (elapsed_ms > 100) {  // è¶…è¿‡ 100ms
    std.debug.print("âš ï¸ æ…¢æŸ¥è¯¢: {d:.2}ms\\n", .{elapsed_ms});
    std.debug.print("SQL: {s}\\n", .{sql});
}</code></pre>

                <div class="note">
                    <div class="note-title">ğŸ’¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®</div>
                    <ul>
                        <li><strong>ç´¢å¼•</strong>: ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•</li>
                        <li><strong>æ‰¹é‡æ“ä½œ</strong>: ä½¿ç”¨äº‹åŠ¡åŒ…è£…æ‰¹é‡æ’å…¥/æ›´æ–°</li>
                        <li><strong>é¢„åŠ è½½</strong>: ä½¿ç”¨ JOIN é¿å… N+1 æŸ¥è¯¢</li>
                        <li><strong>æŒ‡å®šå­—æ®µ</strong>: é¿å… SELECT *ï¼ŒåªæŸ¥è¯¢éœ€è¦çš„å­—æ®µ</li>
                        <li><strong>è¿æ¥å¤ç”¨</strong>: å¤ç”¨æ•°æ®åº“è¿æ¥ï¼Œé¿å…é¢‘ç¹åˆ›å»º</li>
                        <li><strong>æŸ¥è¯¢åˆ†æ</strong>: ä½¿ç”¨ EXPLAIN åˆ†ææ…¢æŸ¥è¯¢</li>
                        <li><strong>ç›‘æ§</strong>: è®°å½•å’Œåˆ†ææŸ¥è¯¢æ€§èƒ½</li>
                    </ul>
                </div>
            </section>

            <!-- æ•°æ®åº“è¿ç§» -->
            <section id="migrations" class="section">
                <h2>æ•°æ®åº“è¿ç§»</h2>
                <p>ORM æä¾›ç¼–è¯‘æ—¶ Schema ç”ŸæˆåŠŸèƒ½ï¼Œå¯è‡ªåŠ¨ä»æ¨¡å‹å®šä¹‰ç”Ÿæˆå»ºè¡¨è¯­å¥ï¼Œæ”¯æŒ MySQLã€SQLiteã€PostgreSQL ä¸‰ç§æ–¹è¨€ã€‚</p>

                <h3>å•æ¨¡å‹è¿ç§»</h3>
                <pre><code>const orm_models = @import("domain/entities/orm_models.zig");

// ç”Ÿæˆå»ºè¡¨ SQLï¼ˆç¼–è¯‘æœŸï¼Œé›¶è¿è¡Œæ—¶å¼€é”€ï¼‰
const create_sql = orm_models.Admin.createTableSql(.mysql);
const drop_sql = orm_models.Admin.dropTableSql();

// æ‰§è¡Œå»ºè¡¨/åˆ è¡¨
try orm_models.Admin.createTable(&db);
try orm_models.Admin.dropTable(&db);</code></pre>

                <h3>æ‰¹é‡è¿ç§»ï¼ˆMigratorï¼‰</h3>
                <pre><code>const sql = @import("application/services/sql/mod.zig");
const Migrator = sql.Migrator;

// æ‰¹é‡åˆ›å»ºè¡¨
try Migrator.createAll(&db, .{
    orm_models.Admin,
    orm_models.Article,
    orm_models.Category,
});

// æ‰¹é‡åˆ é™¤è¡¨ï¼ˆæŒ‰ä¾èµ–å€’åºï¼‰
try Migrator.dropAll(&db, .{
    orm_models.Category,
    orm_models.Article,
    orm_models.Admin,
});

// åˆ·æ–°è¡¨ï¼ˆåˆ é™¤åé‡å»ºï¼‰
try Migrator.refreshAll(&db, 
    .{ Category, Article, Admin },  // drop order
    .{ Admin, Article, Category },  // create order
);</code></pre>

                <h3>ä¾¿æ·å‡½æ•°</h3>
                <pre><code>// è¿ç§»æ‰€æœ‰è¡¨
try orm_models.migrate(&db);

// å›æ»šæ‰€æœ‰è¡¨
try orm_models.rollback(&db);

// åˆ·æ–°æ‰€æœ‰è¡¨
try orm_models.refresh(&db);

// æ‰“å°æ‰€æœ‰å»ºè¡¨ SQLï¼ˆè°ƒè¯•ç”¨ï¼‰
orm_models.printMigrationSql(.mysql);</code></pre>

                <h3>ç±»å‹æ˜ å°„</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Zig ç±»å‹</th>
                            <th>MySQL</th>
                            <th>SQLite</th>
                            <th>PostgreSQL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>?i32</code> (ä¸»é”®)</td>
                            <td>INT AUTO_INCREMENT</td>
                            <td>INTEGER</td>
                            <td>SERIAL</td>
                        </tr>
                        <tr>
                            <td><code>i64</code></td>
                            <td>BIGINT</td>
                            <td>INTEGER</td>
                            <td>BIGINT</td>
                        </tr>
                        <tr>
                            <td><code>[]const u8</code></td>
                            <td>VARCHAR(255)</td>
                            <td>TEXT</td>
                            <td>VARCHAR(255)</td>
                        </tr>
                        <tr>
                            <td><code>*content</code> å­—æ®µ</td>
                            <td>LONGTEXT</td>
                            <td>TEXT</td>
                            <td>TEXT</td>
                        </tr>
                        <tr>
                            <td><code>bool</code></td>
                            <td>TINYINT(1)</td>
                            <td>INTEGER</td>
                            <td>BOOLEAN</td>
                        </tr>
                        <tr>
                            <td><code>f32</code></td>
                            <td>FLOAT</td>
                            <td>REAL</td>
                            <td>REAL</td>
                        </tr>
                        <tr>
                            <td><code>f64</code></td>
                            <td>DOUBLE</td>
                            <td>REAL</td>
                            <td>DOUBLE PRECISION</td>
                        </tr>
                    </tbody>
                </table>
            </table>
            </section>

            <!-- å‘½ä»¤è¡Œå·¥å…· -->
            <section id="cli-tools" class="section">
                <h2>å‘½ä»¤è¡Œå·¥å…·</h2>
                <p>ZigCMS æä¾›äº†ä¸¤ä¸ªå¼ºå¤§çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºè‡ªåŠ¨åŒ–ä»£ç ç”Ÿæˆå’Œæ•°æ®åº“è¿ç§»ç®¡ç†ã€‚</p>

                <h3>ä»£ç ç”Ÿæˆå‘½ä»¤</h3>
                <p>ä»£ç ç”Ÿæˆå·¥å…·å¯ä»¥æ ¹æ®æ•°æ®åº“è¡¨ç»“æ„è‡ªåŠ¨ç”Ÿæˆæ¨¡å‹ã€æ§åˆ¶å™¨ã€DTOç­‰æ–‡ä»¶ï¼Œå¤§å¤§æé«˜å¼€å‘æ•ˆç‡ã€‚</p>

                <h4>å‘½ä»¤è¯­æ³•</h4>
                <pre><code>zig build codegen -- [table_name] [database_type] [connection_params...]</code></pre>

                <h4>å‚æ•°è¯´æ˜</h4>
                <table>
                    <thead>
                        <tr>
                            <th>å‚æ•°</th>
                            <th>è¯´æ˜</th>
                            <th>ç¤ºä¾‹</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>table_name</code></td>
                            <td>è¦ç”Ÿæˆä»£ç çš„æ•°æ®åº“è¡¨å</td>
                            <td><code>users</code></td>
                        </tr>
                        <tr>
                            <td><code>database_type</code></td>
                            <td>æ•°æ®åº“ç±»å‹ (mysql, sqlite, postgres)</td>
                            <td><code>mysql</code></td>
                        </tr>
                        <tr>
                            <td><code>connection_params</code></td>
                            <td>æ•°æ®åº“è¿æ¥å‚æ•°</td>
                            <td>è¯¦è§ä¸‹æ–¹ç¤ºä¾‹</td>
                        </tr>
                    </tbody>
                </table>

                <h4>ä½¿ç”¨ç¤ºä¾‹</h4>
                <pre><code># MySQL è¿æ¥ç¤ºä¾‹
zig build codegen -- users mysql --host=localhost --user=root --password=mypassword --database=myapp

# SQLite è¿æ¥ç¤ºä¾‹  
zig build codegen -- posts sqlite ./database.db

# PostgreSQL è¿æ¥ç¤ºä¾‹
zig build codegen -- articles postgres --host=localhost --user=postgres --password=mypassword --database=myapp</code></pre>

                <h4>ç”Ÿæˆçš„æ–‡ä»¶</h4>
                <p>ä»£ç ç”Ÿæˆå·¥å…·ä¼šè‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š</p>
                <ul>
                    <li><code>domain/entities/[table].model.zig</code> - æ¨¡å‹å®šä¹‰</li>
                    <li><code>api/dto/[table]_create.dto.zig</code> - åˆ›å»º DTO</li>
                    <li><code>api/dto/[table]_update.dto.zig</code> - æ›´æ–° DTO</li>
                    <li><code>api/dto/[table]_response.dto.zig</code> - å“åº” DTO</li>
                    <li><code>api/controllers/[table]_crud.controller.zig</code> - CRUD æ§åˆ¶å™¨</li>
                    <li>è‡ªåŠ¨æ›´æ–° <code>domain/entities/models.zig</code> æ–‡ä»¶</li>
                </ul>

                <h4>è¾“å‡ºä¿¡æ¯</h4>
                <p>å·¥å…·ä¼šè¾“å‡ºåœ¨ main.zig ä¸­éœ€è¦æ·»åŠ çš„è·¯ç”±æ³¨å†Œä»£ç ï¼š</p>
                <pre><code>    try app.crud("users", models.User);</code></pre>

                <h3>æ•°æ®åº“è¿ç§»å‘½ä»¤</h3>
                <p>æ•°æ®åº“è¿ç§»å·¥å…·ç”¨äºç®¡ç†æ•°æ®åº“ç»“æ„çš„å˜æ›´ï¼Œæ”¯æŒåˆ›å»ºã€æ‰§è¡Œã€å›æ»šå’ŒæŸ¥çœ‹è¿ç§»çŠ¶æ€ã€‚</p>

                <h4>å‘½ä»¤è¯­æ³•</h4>
                <pre><code>zig build migrate -- [command] [database_type] [connection_params...]</code></pre>

                <h4>å¯ç”¨å‘½ä»¤</h4>
                <table>
                    <thead>
                        <tr>
                            <th>å‘½ä»¤</th>
                            <th>è¯´æ˜</th>
                            <th>ç¤ºä¾‹</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>create [name]</code></td>
                            <td>åˆ›å»ºæ–°çš„è¿ç§»æ–‡ä»¶</td>
                            <td><code>create users_table</code></td>
                        </tr>
                        <tr>
                            <td><code>up</code></td>
                            <td>æ‰§è¡Œæ‰€æœ‰æœªæ‰§è¡Œçš„è¿ç§»</td>
                            <td><code>up</code></td>
                        </tr>
                        <tr>
                            <td><code>down</code></td>
                            <td>å›æ»šæœ€åä¸€æ¬¡è¿ç§»</td>
                            <td><code>down</code></td>
                        </tr>
                        <tr>
                            <td><code>status</code></td>
                            <td>æŸ¥çœ‹è¿ç§»çŠ¶æ€</td>
                            <td><code>status</code></td>
                        </tr>
                    </tbody>
                </table>

                <h4>ä½¿ç”¨ç¤ºä¾‹</h4>
                <pre><code># åˆ›å»ºæ–°çš„è¿ç§»æ–‡ä»¶
zig build migrate -- create users_table mysql --host=localhost --user=root --password=mypassword --database=myapp

# æ‰§è¡Œè¿ç§»
zig build migrate -- up sqlite ./database.db

# æŸ¥çœ‹è¿ç§»çŠ¶æ€
zig build migrate -- status postgres --host=localhost --user=postgres --password=mypassword --database=myapp

# å›æ»šè¿ç§»
zig build migrate -- down mysql --host=localhost --user=root --password=mypassword --database=myapp</code></pre>

                <h4>è¿ç§»æ–‡ä»¶ç»“æ„</h4>
                <p>è¿ç§»æ–‡ä»¶ä¼šè‡ªåŠ¨ç”Ÿæˆåœ¨ <code>migrations/</code> ç›®å½•ä¸­ï¼ŒåŒ…å« up å’Œ down æ“ä½œï¼š</p>
                <pre><code>//! users_table è¿ç§»æ–‡ä»¶
//!
//! ç”Ÿæˆæ—¶é—´: 20231210120000

const std = @import("std");
const sql = @import("../../application/services/sql/interface.zig");

pub const MigrationInfo = struct {
    name: []const u8 = "users_table",
    timestamp: []const u8 = "20231210120000",
};

// å‘ä¸Šè¿ç§»ï¼ˆåº”ç”¨æ›´æ”¹ï¼‰
pub fn up(db: *sql.Connection) !void {
    _ = db;
    // TODO: åœ¨è¿™é‡Œæ·»åŠ  users_table çš„è¿ç§»é€»è¾‘
    // ä¾‹å¦‚ï¼š
    // try db.exec("CREATE TABLE ...");
    // try db.exec("ALTER TABLE ... ADD COLUMN ...");
}

// å‘ä¸‹è¿ç§»ï¼ˆå›æ»šæ›´æ”¹ï¼‰
pub fn down(db: *sql.Connection) !void {
    _ = db;
    // TODO: åœ¨è¿™é‡Œæ·»åŠ  users_table çš„å›æ»šé€»è¾‘
    // ä¾‹å¦‚ï¼š
    // try db.exec("DROP TABLE ...");
    // try db.exec("ALTER TABLE ... DROP COLUMN ...");
}</code></pre>

                <h4>è¿ç§»è·Ÿè¸ª</h4>
                <p>å·¥å…·ä¼šè‡ªåŠ¨åˆ›å»º <code>migrations</code> è¡¨æ¥è·Ÿè¸ªå“ªäº›è¿ç§»å·²ç»æ‰§è¡Œï¼š</p>
                <pre><code>CREATE TABLE migrations (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    executed_at BIGINT NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
)</code></pre>
            </section>

            <!-- èšåˆå‡½æ•° -->
            <section id="aggregates" class="section">
                <h2>èšåˆå‡½æ•°</h2>
                <p>æ”¯æŒ Laravel é£æ ¼çš„èšåˆæŸ¥è¯¢ï¼šSUMã€AVGã€MINã€MAXã€COUNTã€‚</p>

                <h3>åŸºæœ¬ç”¨æ³•</h3>
                <pre><code>var query = Product.query(&db);
defer query.deinit();

// SUM
const total = try query.whereEq("category", "ç”µå­").sum("price");
// AVG
const avg_price = try query.avg("price");
// MIN / MAX
const min_price = try query.min("price");
const max_price = try query.max("price");
// COUNT
const count = try query.count();</code></pre>

                <h3>OR æ¡ä»¶</h3>
                <pre><code>var query = User.query(&db);
defer query.deinit();

// WHERE status = 1 OR role = 'admin'
_ = query.whereEq("status", 1).orWhereEq("role", "admin");</code></pre>

                <h3>åˆ†ç»„æ¡ä»¶ (Laravel é—­åŒ…é£æ ¼)</h3>
                <p>ç±»ä¼¼ Laravel çš„ <code>->where(function($query) { ... })</code> è¯­æ³•ï¼š</p>
                <pre><code>var query = User.query(&db);
defer query.deinit();

// Laravel: ->where('active', 1)->where(function($q) { 
//              $q->where('role', 'admin')->orWhere('role', 'mod') 
//          })
// SQL: WHERE active = 1 AND (role = 'admin' OR role = 'moderator')

_ = query.whereEq("active", 1).whereGroup(struct {
    fn apply(q: *@TypeOf(query)) void {
        _ = q.whereEq("role", "admin").orWhereEq("role", "moderator");
    }
}.apply);</code></pre>

                <h3>åµŒå¥—æ¡ä»¶æ„å»ºå™¨ï¼ˆæ›´çµæ´»ï¼‰</h3>
                <pre><code>var query = User.query(&db);
defer query.deinit();

// åˆ›å»ºåµŒå¥—æ¡ä»¶
var nested = query.newNested();
_ = nested.whereEq("city", "åŒ—äº¬").orWhereEq("city", "ä¸Šæµ·");

// æ·»åŠ åˆ°ä¸»æŸ¥è¯¢ï¼šWHERE active = 1 AND (city = 'åŒ—äº¬' OR city = 'ä¸Šæµ·')
_ = query.whereEq("active", 1).whereNested(&nested);

// OR åµŒå¥—ï¼šWHERE active = 1 OR (city = 'åŒ—äº¬' AND city = 'ä¸Šæµ·')
// _ = query.whereEq("active", 1).orWhereNested(&nested);</code></pre>

                <h3>æ—¥æœŸæŸ¥è¯¢</h3>
                <pre><code>// WHERE DATE(created_at) = '2025-01-01'
_ = query.whereDate("created_at", "=", "2025-01-01");

// WHERE YEAR(created_at) = 2025
_ = query.whereYear("created_at", "=", 2025);

// WHERE MONTH(created_at) = 12
_ = query.whereMonth("created_at", "=", 12);</code></pre>

                <h3>æ›´å¤š JOIN ç±»å‹</h3>
                <pre><code>// RIGHT JOIN
_ = query.rightJoin("orders", "users.id = orders.user_id");

// INNER JOIN
_ = query.innerJoin("profiles", "users.id = profiles.user_id");

// CROSS JOIN
_ = query.crossJoin("categories");</code></pre>

                <h3>ä¾¿æ·æ–¹æ³•</h3>
                <pre><code>// å¿«æ·æ’åº
_ = query.orderByDesc("created_at");
_ = query.orderByAsc("name");

// éšæœºæ’åº
_ = query.inRandomOrder();

// é‡ç½®æ’åº
_ = query.reorder();

// æ‰¹é‡æ›´æ–°
_ = try query.whereEq("status", 0).updateBatch(.{ .status = 1 });

// åŸå§‹ SELECT
_ = query.selectRaw("COUNT(*) as total, SUM(price) as sum");</code></pre>
            </section>

            <!-- æµ‹è¯• -->
            <section id="testing" class="section">
                <h2>æµ‹è¯•</h2>

                <p>æ¯ç§é©±åŠ¨éƒ½æœ‰å®Œæ•´çš„æµ‹è¯•è¦†ç›–ï¼Œç¡®ä¿åŠŸèƒ½æ­£ç¡®æ€§ã€å†…å­˜å®‰å…¨å’Œçº¿ç¨‹å®‰å…¨ã€‚</p>

                <h3>æµ‹è¯•è¦†ç›–</h3>
                <table>
                    <thead>
                        <tr>
                            <th>æµ‹è¯•ç±»åˆ«</th>
                            <th>è¦†ç›–å†…å®¹</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>CRUD æ“ä½œ</strong></td>
                            <td>åˆ›å»ºã€è¯»å–ã€æ›´æ–°ã€åˆ é™¤åŠç»“æœéªŒè¯</td>
                        </tr>
                        <tr>
                            <td><strong>QueryBuilder</strong></td>
                            <td>SQL æ„é€ å™¨ã€é“¾å¼è°ƒç”¨ã€åˆ†é¡µ</td>
                        </tr>
                        <tr>
                            <td><strong>äº‹åŠ¡</strong></td>
                            <td>æ‰‹åŠ¨æäº¤/å›æ»šã€è‡ªåŠ¨äº‹åŠ¡</td>
                        </tr>
                        <tr>
                            <td><strong>é«˜çº§æŸ¥è¯¢</strong></td>
                            <td>å­æŸ¥è¯¢ã€EXISTSã€NOT EXISTS</td>
                        </tr>
                        <tr>
                            <td><strong>JOIN æŸ¥è¯¢</strong></td>
                            <td>INNER/LEFT/å¤šè¡¨å…³è”</td>
                        </tr>
                        <tr>
                            <td><strong>ORM æ¨¡å‹</strong></td>
                            <td>findã€countã€updateã€destroyã€queryã€collect</td>
                        </tr>
                        <tr>
                            <td><strong>æ–° API</strong></td>
                            <td>List åŒ…è£…å™¨ã€whereEq/Gt/Ltã€whereLikeã€existsã€pluck</td>
                        </tr>
                        <tr>
                            <td><strong>Laravel é£æ ¼</strong></td>
                            <td>æ—  db å‚æ•°è°ƒç”¨ï¼šWhere/WhereEq/Find/Count/Collect</td>
                        </tr>
                        <tr>
                            <td><strong>å…³è”æ¨¡å‹</strong></td>
                            <td>HasManyã€BelongsToã€å…³è”æŸ¥è¯¢æ¡ä»¶</td>
                        </tr>
                        <tr>
                            <td><strong>withDB äº‹åŠ¡</strong></td>
                            <td>withDB().Create/Update/Destroyã€äº‹åŠ¡å›æ»š</td>
                        </tr>
                        <tr>
                            <td><strong>è¾¹ç•Œæ¡ä»¶</strong></td>
                            <td>NULL å€¼ã€ç‰¹æ®Šå­—ç¬¦ã€Unicodeã€å¤§æ•°æ®é‡</td>
                        </tr>
                        <tr>
                            <td><strong>å†…å­˜å®‰å…¨</strong></td>
                            <td>GPA æ£€æµ‹å†…å­˜æ³„æ¼</td>
                        </tr>
                        <tr>
                            <td><strong>è¿æ¥æ± </strong></td>
                            <td>å¹¶å‘æŸ¥è¯¢ã€è¿æ¥å¤ç”¨ï¼ˆMySQLï¼‰</td>
                        </tr>
                    </tbody>
                </table>

                <h3>è¿è¡Œ SQLite æµ‹è¯•</h3>
                <pre><code>cd src/services/sql
zig build-exe sqlite_complete_test.zig -lc -lsqlite3
./sqlite_complete_test</code></pre>

                <h3>è¿è¡Œ MySQL æµ‹è¯•</h3>
                <pre><code>cd src/services/sql

# macOS (Homebrew - Intel / MariaDB)
zig build-exe mysql_complete_test.zig -lc -lmysqlclient \
  -I /usr/local/include \
  -L /usr/local/lib

# macOS (Homebrew - ARM)
zig build-exe mysql_complete_test.zig -lc -lmysqlclient \
  -I /opt/homebrew/include \
  -L /opt/homebrew/lib

./mysql_complete_test</code></pre>

                <h3>æµ‹è¯•è¾“å‡ºç¤ºä¾‹</h3>
                <pre><code>â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          SQLite ORM å®Œæ•´æµ‹è¯•                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
æµ‹è¯• 1: SQLite é©±åŠ¨
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ æ•°æ®åº“è¿æ¥åˆ›å»ºæˆåŠŸï¼ˆå†…å­˜æ¨¡å¼ï¼‰
  é©±åŠ¨ç±»å‹: sqlite

...

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
æµ‹è¯•ç»Ÿè®¡
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  é€šè¿‡: 15
  å¤±è´¥: 0

âœ“ SQLite æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼
âœ“ æ— å†…å­˜æ³„æ¼</code></pre>

                <div class="success">
                    <div class="note-title">âœ“ æµ‹è¯•ä¿éšœ</div>
                    <ul>
                        <li>æ¯æ¬¡ä»£ç å˜æ›´éƒ½è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶</li>
                        <li>ä½¿ç”¨ GPA (GeneralPurposeAllocator) æ£€æµ‹å†…å­˜æ³„æ¼</li>
                        <li>æ–­è¨€éªŒè¯ç»“æœæ­£ç¡®æ€§</li>
                        <li>è¦†ç›–å„ç§è¾¹ç•Œæ¡ä»¶å’Œå¼‚å¸¸æƒ…å†µ</li>
                    </ul>
                </div>
            </section>

            <!-- åº•éƒ¨ -->
            <div class="footer">
                <p>Â© 2025 ZigCMS SQL ORM. ä½¿ç”¨ Zig è¯­è¨€æ„å»ºã€‚</p>
                <p>æ–‡æ¡£é‡‡ç”¨ Fluent Design é£æ ¼è®¾è®¡</p>
            </div>
        </main>
    </div>

    <script>
        // å¹³æ»‘æ»šåŠ¨
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });

                    // æ›´æ–°ä¾§è¾¹æ æ¿€æ´»çŠ¶æ€
                    document.querySelectorAll('.sidebar-menu a').forEach(link => {
                        link.classList.remove('active');
                    });
                    this.classList.add('active');
                }
            });
        });

        // æ»šåŠ¨æ—¶æ›´æ–°ä¾§è¾¹æ æ¿€æ´»çŠ¶æ€
        const sections = document.querySelectorAll('section[id]');
        const observerOptions = {
            root: null,
            rootMargin: '-20% 0px -80% 0px',
            threshold: 0
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.getAttribute('id');
                    document.querySelectorAll('.sidebar-menu a').forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('href') === `#${id}`) {
                            link.classList.add('active');
                        }
                    });
                }
            });
        }, observerOptions);

        sections.forEach(section => observer.observe(section));
    </script>
</body>

</html>