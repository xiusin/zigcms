//! åº”ç”¨å±‚å…¥å£æ–‡ä»¶ (Application Layer)
//!
//! ZigCMS åº”ç”¨å±‚è´Ÿè´£ç¼–æ’ä¸šåŠ¡ç”¨ä¾‹ï¼Œåè°ƒé¢†åŸŸå¯¹è±¡å’ŒåŸºç¡€è®¾æ–½æœåŠ¡ã€‚
//! è¯¥å±‚æ˜¯è¿æ¥ API å±‚å’Œé¢†åŸŸå±‚çš„æ¡¥æ¢ï¼Œå¤„ç†äº‹åŠ¡è¾¹ç•Œå’Œæ•°æ®è½¬æ¢ã€‚
//!
//! ## èŒè´£
//! - å®šä¹‰ä¸šåŠ¡ç”¨ä¾‹å’Œåº”ç”¨æœåŠ¡
//! - åè°ƒé¢†åŸŸå¯¹è±¡æ‰§è¡Œä¸šåŠ¡é€»è¾‘
//! - å¤„ç†äº‹åŠ¡ç®¡ç†å’Œè¾¹ç•Œ
//! - æä¾›åº”ç”¨çº§åˆ«çš„æ¥å£ï¼ˆDTO è½¬æ¢ã€éªŒè¯ç­‰ï¼‰
//!
//! ## æ¨¡å—ç»“æ„
//! - `usecases`: ä¸šåŠ¡ç”¨ä¾‹ï¼ˆç”¨æˆ·æ³¨å†Œã€æ–‡ç« å‘å¸ƒç­‰ï¼‰
//! - `services`: åº”ç”¨æœåŠ¡é›†åˆ
//!   - `manager`: æœåŠ¡ç®¡ç†å™¨
//!   - `orm`: å¯¹è±¡å…³ç³»æ˜ å°„
//!   - `cache`: ç¼“å­˜æœåŠ¡
//!   - `logger`: æ—¥å¿—æœåŠ¡
//!   - `validator`: æ•°æ®éªŒè¯æœåŠ¡
//!
//! ## ä½¿ç”¨ç¤ºä¾‹
//! ```zig
//! const app = @import("application/mod.zig");
//!
//! // ä½¿ç”¨æœåŠ¡ç®¡ç†å™¨
//! var manager = try app.services.manager.init(allocator);
//! defer manager.deinit();
//!
//! // ä½¿ç”¨ ORM æœåŠ¡
//! const User = app.services.orm.Model(UserEntity);
//! const users = try User.all();
//!
//! // ä½¿ç”¨ç¼“å­˜æœåŠ¡
//! try app.services.cache.set("key", "value", 3600);
//! ```
//!
//! ## ä¾èµ–è§„åˆ™
//! - åº”ç”¨å±‚ä¾èµ–é¢†åŸŸå±‚å’Œå…±äº«å±‚
//! - ä¸ç›´æ¥ä¾èµ–åŸºç¡€è®¾æ–½å±‚çš„å…·ä½“å®ç°
//! - é€šè¿‡æ¥å£ä¸åŸºç¡€è®¾æ–½å±‚äº¤äº’

const std = @import("std");
const logger = @import("services/logger/logger.zig");

// ============================================================================
// å…¬å…± API å¯¼å‡º
// ============================================================================

/// ä¸šåŠ¡ç”¨ä¾‹æ¨¡å—
///
/// å®šä¹‰å…·ä½“çš„ä¸šåŠ¡æµç¨‹ï¼Œå¦‚ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€å†…å®¹å‘å¸ƒç­‰ã€‚
/// ç”¨ä¾‹åè°ƒé¢†åŸŸæœåŠ¡å’ŒåŸºç¡€è®¾æ–½æœåŠ¡å®Œæˆä¸šåŠ¡ç›®æ ‡ã€‚
pub const usecases = @import("usecases/mod.zig");

/// åº”ç”¨æœåŠ¡æ¨¡å—
///
/// æä¾›åº”ç”¨å±‚çš„é€šç”¨åŠŸèƒ½æœåŠ¡ï¼ŒåŒ…æ‹¬ ORMã€ç¼“å­˜ã€æ—¥å¿—ã€éªŒè¯ç­‰ã€‚
/// è¿™äº›æœåŠ¡è¢«ç”¨ä¾‹å’Œæ§åˆ¶å™¨ä½¿ç”¨ã€‚
pub const services = struct {
    /// æœåŠ¡ç®¡ç†å™¨ - ç»Ÿä¸€ç®¡ç†æœåŠ¡ç”Ÿå‘½å‘¨æœŸ
    pub const manager = @import("services/services.zig").ServiceManager;

    /// ORM æœåŠ¡ - å¯¹è±¡å…³ç³»æ˜ å°„
    pub const orm = @import("services/orm/orm.zig");

    /// ç¼“å­˜æœåŠ¡ - æ•°æ®ç¼“å­˜
    pub const cache = @import("services/cache/cache.zig");

    /// æ—¥å¿—æœåŠ¡ - ç»Ÿä¸€æ—¥å¿—è®°å½•
    pub const logger = @import("services/logger/logger.zig");

    /// éªŒè¯æœåŠ¡ - æ•°æ®éªŒè¯
    pub const validator = @import("services/validator/validator.zig");
};

// ============================================================================
// å±‚é…ç½®
// ============================================================================

/// åº”ç”¨å±‚é…ç½®
///
/// æ§åˆ¶åº”ç”¨å±‚çš„è¡Œä¸ºï¼Œå¦‚ç¼“å­˜ç­–ç•¥ã€æ’ä»¶ç³»ç»Ÿã€äº‹ä»¶ç³»ç»Ÿç­‰ã€‚
pub const AppConfig = struct {
    /// æ˜¯å¦å¯ç”¨ç¼“å­˜
    enable_cache: bool = true,
    /// ç¼“å­˜é»˜è®¤ TTLï¼ˆç§’ï¼‰
    cache_ttl_seconds: u64 = 3600,
    /// æœ€å¤§å¹¶å‘ä»»åŠ¡æ•°
    max_concurrent_tasks: u32 = 100,

    /// æ˜¯å¦å¯ç”¨æ’ä»¶ç³»ç»Ÿ
    enable_plugins: bool = true,
    /// æ’ä»¶ç›®å½•
    plugin_directory: []const u8 = "plugins",

    /// æ˜¯å¦å¯ç”¨äº‹ä»¶ç³»ç»Ÿ
    enable_events: bool = true,
    /// äº‹ä»¶é˜Ÿåˆ—å¤§å°
    event_queue_size: u32 = 1000,
};

// ============================================================================
// ç”Ÿå‘½å‘¨æœŸç®¡ç†
// ============================================================================

/// åˆå§‹åŒ–åº”ç”¨å±‚
///
/// åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶è°ƒç”¨ï¼Œåˆå§‹åŒ–åº”ç”¨å±‚ç»„ä»¶ã€‚
///
/// ## å‚æ•°
/// - `allocator`: å†…å­˜åˆ†é…å™¨
/// - `config`: åº”ç”¨å±‚é…ç½®
pub fn init(allocator: std.mem.Allocator, config: AppConfig) !void {
    _ = allocator;
    _ = config;

    std.debug.print("âœ… åº”ç”¨å±‚åˆå§‹åŒ–å®Œæˆ\n", .{});

    // åˆå§‹åŒ–ç”¨ä¾‹æ¨¡å—
    _ = usecases;

    // åˆå§‹åŒ–æœåŠ¡
    _ = services;
}

/// æ¸…ç†åº”ç”¨å±‚
///
/// åœ¨åº”ç”¨ç¨‹åºå…³é—­æ—¶è°ƒç”¨ï¼Œé‡Šæ”¾åº”ç”¨å±‚èµ„æºã€‚
pub fn deinit() void {
    std.debug.print("ğŸ‘‹ åº”ç”¨å±‚å·²æ¸…ç†\n", .{});
}
